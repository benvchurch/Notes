\documentclass[12pt]{article}
\usepackage{import}
\import{./}{Includes}

\begin{document}

\atitle{3}
\renewcommand{\ev}[1]{\mathrm{ev}_{#1}}
\renewcommand{\tr}{\mathrm{tr}}
\renewcommand{\det}{\mathrm{det}}
\newcommand{\Endover}[2]{\mathrm{End}_{#1}\left(#2\right)}

\section{Problem 1}

Let $A$ be a Noetherian domain such that $\dim{A} = 1$ with maximal ideal $\p \subset A$. Let $K = \Frac{A}$ and take any $f \in \Frac{K}$ such that $f \notin A_\p$ (e.g. $p^{-1}$ for any $p \in \p$). Consider the ideal
\[ I = (A : f) = \{ x \in A \mid x f \in A \} \]
Then if $x \in I$ we have $x f \in A$ so if $x \in A \setminus \p$ then $f = \frac{xf}{x} \in A_\p$. Since $f \notin A_\p$ we must have $I \subset \p$. Since $A$ is Noetherian and $I$ is proper it has a primary decomposition,
\[ I = \q_0 \cap \q_1 \cap \cdots \cap \q_n \]
such that $\q_i$ is $\p_i$-primary. Therefore,
\[ \sqrt{I} = \sqrt{\q_0} \cap \cdots \cap \sqrt{\q_n} = \p_0 \cap \cdots \cap \p_n \]
which implies that $\p_0 \dots, \p_n \in V(I)$. Furthermore, $\dim{A} = 1$ so each prime $\p_i$ is maximal and thus $V(I) = \{\p_0, \dots, \p_n \}$ since if some prime $\q \supset I$ then $\q \supset \sqrt{I}$ and thus $\q \supset \p_0 \cap \cdots \cap \p_n$ but $\q$ is prime so $\q \supset \p_i$ for some but $\p_i$ is maximal so $\q = \p_i$. In particular there are a finite number of primes above $I$ and since $\p \in V(I)$ we can take $\p_0 = \p$ WLOG. 
\bigskip\\
By prime avoidance $\p_i \not\subset \bigcup_{j \neq i} \p_j$ and thus there exist elements, $a_i \in \p_i \setminus \bigcup_{j \neq i} \p_j$. Then let $\tilde{a} = \prod_{i = 1}^n a_i$ and thus $a_0 \tilde{a} \in \p_0 \cap \cdots \cap \p_n = \sqrt{I}$ so $(a_0 \tilde{a})^N \in I$ for some positive integer $N$. Consider $I' = (A : \tilde{a}^N f) \supset I$. Since $a_0^N \tilde{a}^N \in I$ we know that $a_0^N (\tilde{a}^N f) \in A$ so $a_0^N \in I'$. However, $a_0 \notin \p_i$ for $i > 0$ and thus neither is $a_0^N$ so $I' \not\subset \p_i$ for $i > 0$. But since $I' \supset I$ we have $V(I') \subset V(I)$ so $V(I') = \{ \p \}$. Furthermore, 
\[ g \in A_\q \iff \exists s \in A \setminus \q : s g \in A \iff (A : g) \not\subset \q \] 
Therefore $a_0^N f \notin A_\p$ but $a_0^N f \in A_\q$ for each prime $\q \neq \p$.  

\section{Problem 2}

Let $A$ be a domain an $M$ a torsion-free finite $A$-module. Take $K = \Frac{A}$ and consider the sequence,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & A \arrow[r] & K \arrow[r] & K / A \arrow[r] & 0
\end{tikzcd}
\end{center}
Tensoring with $(-) \otimes_A M$ gives a long exact sequence,
\begin{center}
\begin{tikzcd}
\Tor{R}{1}{K}{M} \arrow[r] & \Tor{R}{1}{K/A}{M} \arrow[r] & A \otimes_A M \arrow[r] & K \otimes_A M \arrow[r] & K/ A \otimes_A M \arrow[r] & 0
\end{tikzcd}
\end{center}
However, $\Tor{R}{1}{K}{M} = 0$ because $K$ is flat. Thus we have,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & \Tor{R}{1}{K/A}{M} \arrow[r] & M \arrow[r] & K \otimes_A M
\end{tikzcd}
\end{center}
However, $\Tor{R}{1}{K/A}{M}$ is the torsion of $M$ and thus vanishes since $M$ is torsion free. Thus the map $M \to K \otimes_A M$ is an injection. Furthermore, $K \otimes_A M$ is a $K$-module and therefore free (since it is a vectorspace) as a $K$-module. Thus if $m_1, \dots, m_n$ generate the image of $M$ in $K \otimes_A M$ then each $m_i$ can be expressed in terms of a basis $b_1, \dots, b_k$ of $K \otimes_A M$. Choosing $d$ large enough to clear all denominators we can write,
\[ M \hookrightarrow d^{-1} (b_1 R \oplus \cdots \oplus b_k R)  \subset K \otimes_A M \] 
which is an inclusion into a free $R$-module.  
\section{078S}

Consider the ring $A = k[x,y] / (y^2 - f(x))$ where $k$ is a field with characteristic not $2$ and,
\[ f(x) = (x - t_1) \cdots (x - t_n) \]
with $t_1, \dots, t_n \in k$ distict and $n \ge 3$ an odd integer. Take the ideal $I = (y, x - t_1) \subset A$. I claim that $I$ is not a free $A$-module of rank $1$. First, if $I$ is not of rank $1$ it cannot free because given a generating set $f_1, \dots, f_n$ then $f_2 \cdot f_1 - f_2 \cdot f_1 = 0$ is a nontrivial $A$-linear combination of the generators that gives zero so it cannot be an $A$-basis. I will complete the proof of this claim at the end.
\bigskip\\
We have $\dim{k[x,y]} = 2$ since $k$ is a field. Then, 
\[ \dim{A} = \dim{k[x,y]} - \height{(y^2 - f(x)} \]
since these rings are f.g. $k$-algebras. However, there are strict inclusions,
\[ (y, x - t_1) \supsetneq (y^2 - f(x)) \supsetneq (0) \]
so $\height{(y^2 - f(x)} = 1$ since its height cannot be $2$ because it is not maximal and it cannot be $0$ because it is not minimal. Therefore $\dim{A} = 1$ so any nonzero $\p \in \Spec{A}$ must then be maximal. Therefore, every $\p \in \Spec{A}$ corresponds to a closed point $\p = (x - a, y - b)$ on the curve. 
\bigskip\\
Now if $\p = (x - a, y - b)$ with $b \neq 0$ then $y \notin \p$. Thus, by Lemma \ref{localize_ideal}, $I_y = A_y$ because $y \in I$. Furthermore, if $\p = (x - a, y)$ then since $\p$ is a prime of $A$ then $\p$ viewed as a prime of $k[x,y]$ must lie above $(y^2 - f(x))$. Thus, $f(a) = 0$ so $a = t_i$ for some $i$. If $i \neq 1$ then take $g = (x - t_1) \notin \p$. Since $g \in I$ then by Lemma \ref{localize_ideal} we have $I_g = A_g$. Finally, for $\p = (x - t_1, y) = I$ we may take $g = (x - t_2) \cdots (x - t_n)$. Now consider the map,
\[ \frac{x - t_1}{y} A_g \to I_g \]
given by sending,
\[ \frac{x - t_1}{y} \to \frac{y}{g} \]
Since $g \notin \p$ this map is clearly injective. We need to show that this map is surjective i.e. that $y A_g$ and $(x - t_1) A_g$ are in the image. This is easily demonstated via noticing that,
\begin{align*}
g \cdot \frac{x - t_1}{y} & \mapsto y 
\\
g \cdot \left( \frac{x - t_1}{y} \right)^2 & \mapsto g \frac{y^2}{g^2} = \frac{y^2}{g} = \frac{(x - t_1) \cdots (x - t_n)}{(x - t_2) \cdots (x - t_n)} = x - t_1
\end{align*}
so the map hits the generators of $I_g$ and thus surjects. 
\bigskip\\
Therefore, we have shown that $I$ is locally free of rank $1$ i.e. $I$ is an invertable $A$-module. Thus, it suffices to show that $I$ is not free of rank $1$ and thus represents a nontrivial class of the Picard group. By using the relations in the ring $A$, we may write an arbitrary element as $\alpha + \beta y$ with $\alpha, \beta \in k[x]$. Consider the norm map, $N : \Frac{A} \to k(x)$ which is the multiplicative map given by sending,
\[ \alpha + \beta y \mapsto  (\alpha + \beta y)(\alpha - \beta y) = \alpha^2 - \beta^2 y^2 = \alpha^2 - \beta^2 f \in k(x) \]
The restriction of this map to $A$ gives a map to $k[x]$.  Suppose that $I = (\pi)$ some generator written as $\pi = \alpha + \beta y$. Since $(\pi) = (y, x- t_1)$ we must have $\pi \divides x - t_1$ and $\pi \divides y$ whcih implies, via the multiplicativity of the norm that, 
\begin{align*}
N(\pi) \divides N(x - t_1) & \implies \alpha^2 - \beta^2 f \divides (x - t_1)^2 
\\
N(\pi) \divides N(y) & \implies \alpha^2 - \beta^2 f \divides f
\end{align*}
However, in $k[x]$ the gcd of $(x - t_1)^2$ and $f$ is $(x - t_1)$ since the roots of $f$ are distinct. Therefore, $N(\pi) \divides (x - t_1)$. However, in order for $\alpha^2 - \beta^2 f$ to divide $x - t_1$ we must have $\deg{(\alpha^2 - \beta^2 f)} \le 1$. But since $\deg{f} > 0$ either $\beta = 0$, in which case, $\alpha^2 \divides x - t_1$ which is impossible unless $\alpha \in k^\times$ because $x - t_1$ is not a square in $k[x]$. In that case $\pi = \alpha \in k^\times$ which cannot generate $I$ since $I$ is proper. Otherwise, for $\deg{(\alpha^2 - \beta^2 f)} \le 1$ we must have the leading terms of $\alpha^2$ and $\beta^2 f$ cancel which implies that they have equal degree. Thus,
\[ 2 \deg{\alpha} = 2 \deg{\beta} + \deg{f} \]
However, by hypothesis, $\deg{f}$ is odd and thus we reach a contradiction so $I$ cannot be principal.  

\section{02DU}

Let $A$ be a ring. 

\subsection{}

Suppose that $M$ a is finite locally free $A$-module and suppose that $\varphi : M \to M$ is an endomorphism. Let $X = \Spec{A}$ and consider the induced endomorphism of $\struct{X}$-modues, $\varphi_* : \tilde{M} \to \tilde{M}$. Because $M$ is finite locally free, at each $\p \in \Spec{A}$ there exists $f \in A$ such that $\p \in D(f)$ (i.e. $f \notin \p$) and $\tilde{M}(D(f)) = M_f$ is a free $A_f$-module. Therefore, $\tilde{\varphi} : \tilde{M}(D(f)) \to \tilde{M}(D(f))$ is a map of free $A_f$-modules which has a standard trace and determinant in $A_f = \struct{X}(D(f))$ computed via the matrix representation denoted by $\tr_f(\varphi) \in A_f$ and $\det_f(\varphi) \in A_f$. We need to show that these sections agree on overlaps. Choose a basis $e_1, \dots, e_n$ of $M_f$ as an $A_f$-module so $M_f = e_1 A_f \oplus \cdots \oplus e_n A_f \cong A_f^{\oplus n}$. 
We have,
\[ \widetilde{M}|_{D(f)} \cong \widetilde{M_f} \cong \wt{A_f^{\oplus n}}  \cong \struct{X} |_{D(f)}^{\oplus n} \] 
This gives a diagram,
\begin{center}
\begin{tikzcd}
\wt{M}(D(f)) \arrow[r, "\sim"] \arrow[d] & \struct{X}(D(f))^{\oplus n} \arrow[d]
\\
\wt{M}(D(g)) \arrow[r, "\sim"]  & \struct{X}(D(g))^{\oplus n}
\end{tikzcd}
\end{center}
Since the right restriction map sends an $A_f$ basis to an $A_g$ basis, the same must be true of the left restriction map. 
Then given $D(g) \subset D(f_1) \cap D(f_2)$ then we can write $\varphi(e_i^k) = \sum_{j = 1}^n B^k_{ji} e^k_j$ for $k = 1,2$ and we have $\tr_{f_k} = \sum_{i = 1}^n B^k_{ii}$ as an element of $A_{k_k}$. Under restriction, both $\{e^{k}_i \}$ for $k = 1,2$ are sent to a $A_g$-basis of $M_g$. Therefore, since we have the diagram,
\begin{center}
\begin{tikzcd}
\wt{M}(D(f)) \arrow[r, "\varphi"] \arrow[d] & \wt{M}(D(f)) \arrow[d]
\\
\wt{M}(D(g)) \arrow[r, "\varphi"]  & \wt{M}(D(f))
\end{tikzcd}
\end{center}
The matrix elements for $\varphi : M_g \to M_g$ in the restriction basis must be the restiction ($A_f \to A_g$) of the matrix elements of $\varphi : M_f \to M_f$ since,
\begin{align*}
\res(\varphi(e^k_i)) & = \res\left( \sum_{j = 1}^n B^k_{ji} e^k_j \right) = \sum_{j = 1}^n \res_A(B^k_{ji}) \res(e^k_j)
\end{align*}
However, $\res \circ \varphi = \varphi \circ \res$ and $\res(e'_i)$ is also a basis with matrix $B'^k_{ij}$ so we have,
\[ \res(\varphi(e^k_i)) = \varphi(\res(e^k_i)) = \sum_{j = 1}^n B'^k_{ji} \res(e^k_j) \]
proving the claim. Therefore, we can compute the trace and determinant in either basis $B'^k_{ij}$ which must be equal since they are coordinate independent,
\[ \tr_g = \sum_{i = 1}^n B'^k_{ii} = \sum_{i = 1}^n \res_A(B^k_{ii}) = \res_A\left( \sum_{i = 1}^n B^k_{ii} \right) = \res_A(\tr_{f_k}) \]
where I simply used the fact that $\res_A : A_{f_k} \to A_g$ is a ring map. Similarly, expressing the determinant in either induced basis we find,
\[ \det_g = \det{B'^k} = \det{(\res_A(B^k))} = \res_A{(\det{B^k})} = \res_A(\det_{f_k}) \]
Therefore, both the determinant and trace agree when restricted to the overlap. Thus, we may glue to obtain unique global sections $\tr{\varphi}$ and $\det{\varphi}$. 
\bigskip\\
Let $M$ be a finite locally-free $A$ module and $N$ a finite locally-free $B$-module. Consider a ring map $r : A \to B$ and compatible module map $g : M \to N$ and two endomorphisms $\varphi : M \to M$ and $\psi : N \to N$ compatible with the module maps such that,
\begin{center}
\begin{tikzcd}[row sep = large, column sep = large]
M \arrow[r, "\varphi"] \arrow[d, "g"'] & M \arrow[d, "g"]
\\
N \arrow[r, "\psi"] & N
\end{tikzcd}
\end{center} 
commutes. Viewing $N$ as an $A$-module, the above commutes as a diagram of $A$-module maps. I am not sure what being functorial in this triple means for a section such as $\tr{\varphi} \in A$ since the sections $\tr{\varphi}$ and $\tr{\psi}$ are not, in general, equal (consider $M \subset N$ vectorspaces over $A = k$ of different dimension and $\varphi$, $\psi$ the corresponding identity maps which clearly make the square commute but have different traces). 

\subsection{}

Locally, the trace is computed standardly on maps of free modules. Given maps $\varphi : M \to N$ and $\psi : N \to M$ of finite locally free $A$-modules, about each point $\p \in \Spec{A}$ choose a neighborhood $D(f)$ such that both $M_f$ and $N_f$ are free. Then the localized maps $\varphi_f : M_f \to N_f$ and $\psi_f : N_f \to M_f$ satisfy $\tr{(\varphi_f \circ \psi_f)} = \tr{(\psi_f \circ \varphi_f)}$ and $\det{(\varphi_f \circ \psi_f)} = \det{(\psi_f \circ \varphi_f)}$ for standard linear algbra reasons. The global traces and determinants restrict uniquely to these local traces and determinants which forces $\tr{(\varphi \circ \psi)} = \tr{(\psi \circ \varphi)}$ and $\det{(\varphi \circ \psi)} = \det{(\psi \circ \varphi)}$ since both global sections restrict to the same local sections on some cover. 

\subsection{}

Let $M$ be a finite locally-free $A$-module. Consider the map $\tr : \Endover{A}{M} \to A$ defined above. Let $\varphi, \psi : M \to M$ be endomorphisms and $a, b \in A$. Then consider $\tr{(a \varphi + b \psi)}$. For each point $\p \in \Spec{A}$ there exists an open neigborhood $D(f)$ such that $M_f$ is free. Furthermore, by construction, the trace $\tr{(a \varphi + b \psi)}$ restricts to $\tr_f(a \varphi + b \psi)$ which is the trace of the map $a \varphi + b \psi : M_f \to M_f$ which satisfies 
\[\tr_f(a \varphi + b \psi) = a \: \tr_f{\varphi} + b \: \tr_f{\psi} \]
for standard linear algebra reasons on free modules. Thus, $a\:  \tr{\varphi} + b \: \tr{\psi}$ restricts to the same local sections as $\tr{(a \varphi + b \psi)}$ on an open cover and thus they must be equal as global sections. The exact same argument shows that $\det{(\varphi \circ \psi)} = \det{(\varphi)} \det{(\psi)}$. 

\section{Lemmas}

\begin{lemma} \label{localize_ideal}
Let $I \subset A$ be an ideal and $f \in I$ then $I_f = A_f$.
\end{lemma}

\begin{proof}
Consier the exact sequence of $A$-modules,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & I \arrow[r] & A \arrow[r] & A / I \arrow[r] & 0 
\end{tikzcd}
\end{center}
Since localization is an exact functor we get the exact sequence,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & I_f \arrow[r] & A_f \arrow[r] & (A / I)_f \arrow[r] & 0
\end{tikzcd}
\end{center}
However, since $f \in I$ then $[f] = 0$ in $A / I$ which implies that $(A / I)_f = 0$. Therefore the inclusion $I_f \to A_f$ is an isomorphism. 
\end{proof}



\end{document}
