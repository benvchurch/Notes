\documentclass[12pt]{article}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=blue,
}

\usepackage{import}
\import{../}{AlgGeoCommands}

\begin{document}

\newcommand{\Ad}{\mathrm{Ad}}
\newcommand{\gl}{\mathfrak{gl}}
\newcommand{\Hod}{\mathrm{Hod}}

\section{Introduction}
Our goal is to understand which groups arise as the fundamental group of a smooth complex variety $\pi_1(X(\CC))$. This is a daunting task. To limit our scope very slightly, we study the complex representation theory of $\pi_1(X(\CC))$. 
Let us consider a representation,
\[ \rho : \pi_1(X(\CC)) \to \GL_r(\CC) \]
Orginary Hodge theory provides a description the deformation space of $1$-dimensional representations. Indeed, for $r = 1$ we are asking about characters,
\[ \pi_1(X(\CC)) \to \CC^\times \]
A deformation of this character is given by,
\[ \Hom{}{\pi_1(X(\CC))}{\CC} = H^1(X, \CC) = H^1(X, \struct{X}) \oplus H^0(X, \Omega) \]
Therefore we get a decomposition of the tangent space into two directions: the first represents the deformations of a holomorphic line bundle and the second the deformations of a holomorphic $1$-form. Furthermore, we can say that given a character $\pi_1(X(\CC)) \to \CC^\times$ this defines a local system and hence a line bundle $\L$ and the above decomposition relates to the deformations of $\L$ and of a $1$-form. 
\bigskip\\
Non-abelian Hodge theory generalizes this decomposition for the spaces,
\[ H^1(\pi_1(X(\CC)), \GL_r(\CC)) := \Hom{}{\pi_1(X(\CC))}{\GL_r(\CC)} / \GL_r(\CC) \]
which we interpret as the set $\CC$-points of a moduli space of representations. At a given representation $\rho : \pi_1(X(\CC)) \to \GL_r(\CC)$ defining a local system this defines a vector bundle $E$ and non-abelian Hodge theory gives an analogous decomposition of the tangent space at $\rho$ in terms of $E$,
\[ T_{[\rho]} M_B :=  H^1(X, \End{E}) \oplus H^0(X, \End{E} \ot \Omega^1) \]
The first term again parametrizes the deformations of $E$ while the second term involves $1$-forms.
Notice that unlike the case $r = 1$, this decomposition is not globally a direct sum since the factors depend on $E$ in a nontrivial way. We should think of the right-hand-side as the tangent space to a moduli space of new objects called Higgs bundles which are vector bundles along with an extra $1$-form structure. Then we get a correspondence between representations and Higgs bundles. Often people write schematically to show the connection to Hodge theory,
\[ ``H^1(\pi_1(X(\CC)), \GL_r) =  H^1(X, \GL_r) \oplus H^0(X, \GL_r \ot \Omega^1)'' \]
I would not take this statement or notation very seriously. On tangent spaces this becomes precise as an isomorphism,
\[ H^1(\pi_1(X(\CC)), \Ad{\rho}) = H^1(X, \End{E}) \oplus H^0(X, \End{E} \ot \Omega^1) \]

\begin{rmk}
The identification of $H^1(\pi_1, \Ad{\rho})$ with the tangent space at $[\rho]$ of the character variety is as follows. We deform the map $\rho : \pi \to \GL_r$ via,
\[ \gamma \mapsto (1 + \epsilon \eta(\gamma)) \cdot \rho(\gamma) \]
where $\eta(\gamma) \in \gl_r$ and the second term forms a right-invariant vector field. Then we require,
\[ \gamma_1 \gamma_2 \mapsto [(1 + \epsilon \eta(\gamma_1)) \cdot \rho(\gamma_1)][(1 + \epsilon \eta(\gamma_2)) \cdot \rho(\gamma_2)] = (1 + \epsilon \eta(\gamma_1 \gamma_2)) \cdot \rho(\gamma_1 \gamma_2) \]
and hence,
\[ \eta(\gamma_1 \gamma_2) = \eta(\gamma_1) + \rho(\gamma_1) \eta(\gamma_2) \rho(\gamma_1^{-1}) \]
meaning that $\eta$ is a crossed-hom for the adjoint action. Furthermore, a deformation is induced by the conjugation action if there exists $B \in \gl_r$ such that,
\[ \gamma \mapsto (1 + \epsilon B) \rho(\gamma) (1 + \epsilon B)^{-1} = \rho(\gamma) + \epsilon [B \rho(\gamma) - \rho(\gamma) B] = (1 + \epsilon [B - \rho(\gamma) B \rho(\gamma)^{-1}]) \cdot \rho(\gamma) \]
theremore meaning exactly that $\eta$ is a principal crossed homomorphism for the adjoint action.
\end{rmk}

\section{Higgs Bundles}

In this section we work on a smooth variety $X$.

\begin{defn}
A \textit{Higgs bundle} is a pair $(\E, \phi)$ where $\E$ is a vector bundle and $\phi$ is a $\struct{X}$-linear map,
\[ \phi : \E \to \E \ot_{\struct{X}} \Omega_X^1 \]
such that $\phi \wedge \phi = 0$.
\end{defn}

\begin{rmk}
We should define the notation $\phi \wedge \phi$. Such a linear map is equivalent to a section of,
\[ \phi \in \Gamma(X, \End{\E} \ot_{\struct{X}} \Omega^1_X) \]
We endow $\End{\E} \ot_{\struct{X}} \Omega^\bullet_X$ with the structure of a sheaf of graded $\struct{X}$-algebras under the following operation,
\[ (\varphi_1 \ot \omega_1, \varphi_2 \ot \omega_2) \mapsto (\varphi_1 \circ \varphi_2) \ot (\omega_1 \wedge \omega_2) \]
then extended $\struct{X}$-linearly. This operation is denoted $\wedge$. However, do not let this mislead you into thinking that $\wedge$ is antisymmetric since if $\rank{\E} > 1$ then the composition in $\End{\E}$ is noncommutative. Hence $\phi \wedge \phi = 0$ is a nontrivial condition when $\E$ has rank at least $2$.
\end{rmk}

\begin{rmk}
We refer to $\phi \wedge \phi = 0$ as the \textit{integrability} condition. This is because we call a flat connection integrable. We will now spell out the relationship of Higgs bundles to flat connections. 
\end{rmk}

There are a number of ways to motivate the definition of a Higgs bundle. My favorite is to think of them as degenerations of a flat connection where we send the nonlinear part to zero. In order to make this precise we introduce the notion of a $t$-connection.

\begin{defn}
Let $X$ be an $S$-scheme. Let $\E$ be a coherent sheaf on $X$. A $t$-\textit{connection} on $\E$ over $X/S$ is a triple $(t, \E, \nabla)$ where $t : X \to \A^1_S$ is a global function and $\nabla$ is a $S$-linear map,
\[ \nabla : \E \to \E \ot \Omega^1_X \]
satisfying the $t$-scalled Liebniz law,
\[ \nabla(f s) = t \d{f} \ot s + f \nabla s \] 
\end{defn}

\begin{rmk}
Notice that if $t = 0$ then $\nabla$ is $\struct{X}$-linear.
\end{rmk}

\begin{defn}
There is a natural extension of $\nabla$ to,
\[ \nabla_p : \E \ot_{\struct{X}} \Omega^p_X \to \E \ot_{\struct{X}} \Omega^{p+1}_X \]
defined on pure tensors as follows
\[ \nabla_p(s \ot \omega) = t s \ot \d{\omega} + (-1)^p \nabla s \wedge \omega \]
Then we define the curvature of $\nabla$,
\[ \omega_{\nabla} = \nabla_1 \circ \nabla \]
A straightforward calculation shows that,
\[ \omega_{\nabla} : \E \to \E \ot \Omega^2_X \]
is $\struct{X}$-linear. We say that $\nabla$ is \textit{flat} or \textit{integrable} if $\omega_{\nabla} = 0$. In this case $\nabla$ is a differential meaning the de Rham complex,
\[ 0 \to \E \xrightarrow{\nabla} \E \ot \Omega^1_X \xrightarrow{\nabla_1} \E \ot \Omega_X^2 \xrightarrow{\nabla_2} \E \ot \Omega_X^3 \to \cdots \]
is actually a complex.
\end{defn}

\begin{rmk}
Notice in the case that $t = 0$ we saw $\nabla$ is $\struct{X}$-linear. Call $\phi := \nabla$. Then notice,
\[ \omega_{\nabla}(s) = \nabla_1 \circ \nabla(s) = \nabla_1 \left( \sum_i s_i \ot \omega_i \right) = - \phi(s_i) \wedge \omega_i = - (\phi \wedge \phi)(s) \] 
where,
\[ \phi(s) = \sum_i s_i \ot \omega_i \]
Therefore, $\phi \wedge \phi = 0$ if and only if the $t$-connection $\nabla$ is flat. 
\end{rmk}

The previous calculation shows that a $t$-connection is a gadget that interpolates between a flat connection on $X_1$ over $t = 1$ and a Higgs bundle on $X_0$ over $t = 0$. If we take the constant $t$-scheme $X \times \A^1 \to \A^1$ and a constant coherent sheaf $\pi_1^* \E$ then a $t$-connection is litterally just linearly interpolating between a connection on $\E$ and a Higgs bundle structure on $\E$. This picture is completely functorial so we get a universal interpretation,
\begin{center}
\begin{tikzcd}
\M_{\text{Dol}}(X) \arrow[d] \arrow[r, hook] & \M_{\text{Hod}}(X) \arrow[d] & \M_{\text{dR}}(X) \arrow[l, hook] \arrow[d]
\\
\{ t = 0 \} \arrow[r, hook] & \A^1 & \{ t = 1 \} \arrow[l, hook] 
\end{tikzcd}
\end{center}
so we get a moduli space $\M_{\Hod}(X)$ of flat $t$-connections $(t, \E, \nabla)$ with a $\Gm$-equivariant map,
\[ \M_{\text{Hod}}(X) \to \A^1 \quad \quad (t, \E, \nabla) \mapsto t \]
where the $\Gm$-acts via,
\[ \lambda \cdot (t, \E, \nabla) = (\lambda t, \E, \lambda \nabla) \]

\section{Variation of Hodge Structures}

We have seen that a Higgs bundle is morally a ``linearized connection''. These arise from the somewhat artificial construction of a $t$-connection. However, they also arise from a much more natural object: a polarized $\CC$-variation of Hodge structures. 

\begin{defn}
A \textit{complex variation of Hodge structures of weight} $k$ over a algebraic (or analytic) variety $S$ is the data $(V, V^{p,q})$ of,
\begin{enumerate}
\item a $\CC$-local system $V$
\item analytic subbundles $V^{p,q}$ of $V \ot \struct{S}$ with $p + q = k$
\end{enumerate}
such that,
\begin{enumerate}
\item for each $s \in S$,
\[ V_s = \bigoplus_{p+q=k} V^{p,q}_s \]
\item the subbundles,
\[ F^p := \bigoplus_{i \ge p} V^{i, k - i} \]
are holomorphic and,
\[ \ol{F}^q := \bigoplus_{i \le k-q} V^{i, k-i} \]
is anti-holomorphic
\item let $\nabla$ be the flat connection induced on $V \ot \struct{S}$. Then,
\[ \nabla_X F^p \subset F^{p-1} \quad \nabla_X \ol{F}^q \subset \ol{F}^{q-1} \]
for any local vectorfield $X$. 
\end{enumerate}
\end{defn}

\begin{rmk}
In the case of a $\Z$ or $\Q$ or $\RR$-variation of Hodge structures where we have a real structure on the vectorspace the data of $F^p$ alone is sufficient to determine the Hodge structure since $\ol{F}^p$ is the complex conjugate and $V^{p,q} = F^p \cap \ol{F}^q$. However, without the $\RR$ structure we cannot recover $\ol{F}^q$ from $\ol{F}^p$.
\end{rmk}

We abuse notation by letting $V$ refer to both the underlying local system and the holomorphic vector bundle $V \ot \struct{S}$ and the underlying $C^{\infty}$-vector bundle.

\begin{defn}
A \textit{polarization} of a complex variation of Hodge structure $(V, V^{p,q})$ is a Hermitian form $\psi : V \ot V \to \CC$ which is parallel for the flat connection $\nabla$ satisfying the so-called Riemann bilinear relations:
\begin{enumerate}
\item the decomposition,
\[ V = \bigoplus_{p+q = k} V^{p,q} \]
is orthogonal for $\psi$
\item $(-1)^{p-k} \psi$ is positive definite on $V^{p,q}$
\end{enumerate}
\end{defn}

\begin{rmk}
Note that usually a polarization is given in terms of a bilinear form $Q$ such that $\psi(u,v) = Q(u,h(i) \bar{v})$ a definite Hermitian form on each $V^{p,q}$ for which the Hodge decomposition is orthogonal.
\end{rmk}

\begin{prop}
Let $(V, V^{p,q}, \nabla, \psi)$ be a complex polarized variation of Hodge structures. Then, the maps,
\[ \nabla : F^p / F^{p+1} \to (F^{p-1} / F^{p}) \ot \Omega^1_S \] 
are linear because if $f$ is a local section of $F^p$ then $\nabla(sf) = s \nabla f + f \ot \d{s}$ but $f \ot \d{s}$ is a section of $F^p \ot \Omega_S^1$ and hence zero in the quotient. Furthermore, since $F^p / F^{p+1} = V^{p,k-p}$ we get linear maps,
\[ \theta^p : V^{p,k-p} \to V^{p-1,k-p+1} \ot \Omega^1_S \]
which define a Higgs field $\theta$ on $V$. This defines a \textit{graded Higgs bundle} 
\end{prop}

\begin{rmk}
The vector bundles $E^{p,q} = F^p / F^{p+q}$ are holomorphic. However, the identification $V^{p,q} = F^p / F^{p+q}$ is not holomorphic in the sense that $F^p / F^{p+q} \embed V$ is not necessarily a map of holomorphic vector bundles.
\end{rmk}


\begin{defn}
A graded Higgs bundle $\big( \bigoplus\limits_{i+j = k} E^{i,j}, \theta \big)$ is a Higgs bundle on a graded holomorphic vector bundle,
\[ E = \bigoplus_{i + j = k} E^{i,j} \]
where the Higgs field $\theta$ is the sum of linear maps,
\[ \theta^i : E^{i,j} \to E^{i-1,j+1} \ot \Omega^1_S \]
\end{defn}


One of the main theorems of Hitchin and Simpson shows that this construction can be reversed. The graded Higgs bundle contains all of the information in the polarized variation of Hodge structures. 

\begin{theorem}[Simpson, Hitchin]
The functor,
\[ \left\{ \text{complex polarized VHS } (V, V^{p,q}, \nabla, \psi) \right\} \xrightarrow{\mathrm{Gr}_{F^\bullet}} \left\{ \text{graded Higgs bundles } \big( \bigoplus_{i+j = k} E^{i,j}, \theta \big) \right\} \]
is an equivalence of categories onto the subcategory of polystable graded Higgs bundles with trivial chern classes.
\end{theorem}

\section{Stability Conditions}

We fix an ample class $H$ on $X$ (or as Simpson does, fix a Kahler class on $X$).

\begin{defn}
The slope of a torsion-free coherent sheaf $\F$ is,
\[ \mu(\F) := \frac{c_1(\F) \cdot H^{n-1}}{\rank{\F}} \]
\end{defn}

\begin{defn}
A subsheaf $\F \subset E$ of a Higgs bundle $(E, \phi$) is $\phi$-\textit{stable} if $\phi(\F) \subset \F \ot \Omega^1_X$.
\end{defn}

\begin{defn}
We say that a Higgs bundle $(E, \psi)$ is,
\begin{enumerate}
\item (semi)-stable if for all $\phi$-stable coherent subsheaf $0 \subsetneq \F \subsetneq E$ then $\mu(\F) < \mu(E)$ (resp. $\le$)
\item polystable if it is a direct sum of stable Higgs bundles of the same slope.
\end{enumerate}
\end{defn}

\section{Moduli Spaces}

\newcommand{\Dol}{\mathrm{Dol}}

There are three Moduli problems we are concerned with:
\begin{enumerate}
\item  $\M_B(X)$ the moduli of local systems (representations of $\pi_1(X(\CC))$)
\item $\M_{\dR}(X)$ the moduli of vector bundles with flat connection
\item $\M_{\Dol}(X)$ the moduli of Higgs bundles 
\end{enumerate}

The first two are related by the Riemann-Hilbert correspondence. We saw that there was a degeneration $\M_{\dR} \spto \M_{\Dol}$ so we should expect that their underlying topological spaces might be related. It will be more convenient to work in terms of the GIT coarse space (the corresponding good moduli spaces of these moduli stacks). 

\begin{theorem}
There exist homeomorphisms (diffeomorphisms over the smooth loci) of the coarse moduli spaces,
\[ M_{\Dol}^{ss} \cong_h M_B^{ss} \cong M_{\dR} \]
where $M_B^{ss}$ coarse space parametrizing semisimple representations and $M_{\Dol}^{ss}$ is the coarse space of semistable Higgs bundles. Morover, this restricts to homeomorphisms,
\[ M_{\Dol}^{s} \cong_h M_B^{+} \cong M_{\dR}^{+} \]
where $M_B^{+}$ is the fine character variety of irreducible representations and $M_{\Dol}^{s}$ is the fine moduli space of stable Higgs bundles\footnote{These moduli spaces are fine since the stable/irreducible objects have non-scalar automorphisms} and $M_{\dR}^{+}$ is the fine moduli space of irreducible vector bundles with flat connections.
\end{theorem}

\begin{rmk}
The second map $M_B \cong M_{\dR}$ is an isomorphism of complex analytic spaces (it is not algebraic) via the Riemann-Hilbert correspondence. However, the maps $M_{\Dol}^{ss} \to M_B^{ss}$ are not. Transporting the complex structure on $M_B^{ss}$ to $M_{\Dol}^{ss}$ gives an additional complex structure $J$ in addition to the natural complex structure $I$ on $M_{\Dol}^{ss}$. These are not equal. In fact, we will show that $IJ = -JI$. Therefore if $K = IJ$ then $I,J,K$ form a representation of the quaternions and hence $M_{\Dol}^{ss}$ becomes a hyperkahler manifold.
\end{rmk}

\subsection{The Correspondence}


\newcommand{\dbar}{\bar{\partial}}
\newcommand{\hol}{\mathrm{hol}}

We want to describe a map $M_{\dR} \to M_{\Dol}$. 
\bigskip\\
Let $(E, \nabla)$ be a flat vector bundle. We choose a hermitian metric $h$ on $E$. Then there is a unique decomposition,
\[ \nabla = \nabla_h + \Psi \]
where $\nabla_h$ satisfies $\nabla_h h = 0$ and $\Psi$ is self-adjoint for $h$. Then we get a Higgs bundle,
\[ (E, \dbar_E = \nabla_h^{0,1}, \Phi = \Psi^{1,0}) \]
as long as $(\nabla_h^{0,1})^2 = 0$  and $\dbar_E \Phi = 0$. These both follow from the flatness $\nabla^2 = 0$. Indeed,
\[ F_{\nabla_h} + \nabla \Psi + \Psi \wedge \Psi = 0 \] 
\bigskip\\
Going backward, if we start with $(E, \dbar_E, \phi)$ then we need to recover $\nabla = \nabla_h + \Psi$. Let's assume we can recover the metric $h$ on $E$ that we used in the other direction. Then $\nabla_h$ is just the Chern connection and $\Psi^{0,1} = \psi$ but $\Psi$ is self-adjoint so $\Psi = \psi + \psi^{\dagger}_h$. Therefore,
\[ \nabla = \nabla_h + \psi + \psi^{\dagger}_h \]
Then the integrability condition becomes,
\[ F_{\nabla} = F_{\nabla_h} + [\psi, \psi^{\dagger}_h] = 0 \]
This is called the \textit{Hitchin equation}. We will need to show that there exists a metric that solves this equation. 

\section{$G$-Higgs Bundles}

What we have defined so far is a $\GL_r$-Higgs bundle since its underlying structure is a vector bundle i.e. a principle $\GL_r$-vector bundle. We can generalize this to any connected reductive group $G$. 


\newcommand{\ad}{\mathrm{ad}}
\newcommand{\g}{\mathfrak{g}}

\begin{defn}
Let $P$ be a principal $G$-bundle and $\ad(P) = P \times_{\ad} \g$ the adjoint bundle. Define an operation $[-,-]$ endowing $\ad(P) \ot \Omega^{\bullet}_X$ with the structure of a sheaf of graded $\struct{X}$-algebras by,
\[ (\xi_1 \ot \omega_1, \xi_2 \ot \omega_2) = [\xi_1, \xi_2] \ot (\omega_1 \wedge \omega_2)  \]
\end{defn}

\begin{defn}
A $G$-Higgs bundle is a pair $(P, \Phi)$ of a principal $G$-bundle and a section,
\[ \Phi \in H^0(X, \ad(P) \ot \Omega_X^1) \quad \text{ such that } \quad [\Phi, \Phi] = 0 \]
\end{defn}

\section{References}


\section{Harmonic Bundles}

We should first disambiguate ''vector bundle with flat connection''. On a holomorphic vector bundle $E$ we could have two notions of a flat connection: a holomorphic connection which is a map,
\[ \E_{\hol} \to \E_{\hol} \ot (\Omega^1_X)_{\hol} \]
satisfing the flatness condition,
or a connection on the underlying smooth vector bundle,
\[ \E_{C^{\infty}} \to \E_{C^{\infty}} \ot (\Omega^1_X)_{C^{\infty}} \]
which satisfies an identical flatness condition. It is clear that the former induces the later. Much more surprisingly, this is a bijection between these two types of connections (using flatness in an essential way here!). 
\bigskip\\
Indeed if $(E, \nabla)$ is a vector bundle with a flat connection we first claim that $E$ has a canonical holomorphic structure for which $\nabla$ is compatible. Indeed, a holomorphic structure on $E$ is uniquely determined by an operator $\dbar_E : \cA^0(E) \to \cA^{0,1}(E)$ satisfying the Leibnitz law and $(\dbar_E)^2 = 0$ so we set $\dbar_E = \nabla^{0,1}$. Since the curvature of $\nabla$ vanishes,
\[ (\nabla^{1,0} + \nabla^{0,1})^2 = 0 \implies (\nabla^{1,0})^2 = (\nabla^{0,1})^2 = \nabla^{0,1} \circ \nabla^{1,0} + \nabla^{1,0} \circ \nabla^{0,1} = 0 \] 
Therefore setting $\dbar_E = \nabla^{0,1}$ defines a holomorphic structure. Then I claim that $\nabla^{1,0}$ is a holomorphic connection. Indeed, we just need to check that if $s$ is a holomorphic section of $E$ then $\nabla^{1,0} s$ is a holomorphic section of $\Omega_X^1 \ot E$. However, $\nabla^{1,0} \circ \nabla^{0,1} + \nabla^{0,1} \circ \nabla^{1,0} = 0$ so applying this operator to $s$ and recalling that $\nabla^{0,1} s = 0$ by definition of a holomorphic section we get,
\[ \nabla^{0,1} \circ \nabla^{1,0} s = 0 \]
proving that $\nabla^{1,0} s$ is holomorphic. Thus $(E, \nabla)$ is equivalent to the data of a holomorphic vector bundle with a flat holomorphic connection.

Note that we can package the data (holomorphic structure and Higgs field) of a Higgs bundle into a tripple $(E, \dbar_E, \phi)$ such that,
\[ (\dbar_E + \phi)^2 = 0 \]

\begin{defn}
A \textit{hermitian bundle} is a pair $(E, h)$ of a complex (smooth) vectorbundle $E$ and a bilinar map $h : E \oplus E \to \CC$ which is fiberwise a hermitian metric.
\end{defn}

\begin{defn}
Let $(E, h)$ be a hermitian bundle. We say that a connection $\nabla$ on $E$ is \textit{hermitian} or \textit{unitary} if $\nabla h = 0$. Expliticly, this means for any two local sections $s_1, s_2$ of $E$,
\[ h(\nabla s_1, s_2) + h(s_1, \nabla s_2) = 0 \] 
\end{defn}

\begin{theorem}
If $(E, h)$ is a holomorphic hermitian bundle there is a unique hermitian connection $\nabla$ compatible with the complex structure in the sense that $\nabla^{0,1} = \bar{\partial}_E$. We call $\nabla$ the \textit{Chern connection}.
\end{theorem}



\begin{theorem}
\begin{enumerate}
\item A flat bundle $V$ has a harmonic metric if and only if it is semisimple
\item A Higgs bundle $E$ has a Hermitian-Yang-Mills metric if and only if it is polystable. 
\item the Hermitian-Yang-Mills metric is harmonic if and only if $\ch_1(E) \cdot [\omega]^{\dim{X}-1} = 0$ and $\ch_2(E) \cdot [\omega]^{\dim{X}-2} = 0$.
\end{enumerate}
\end{theorem}

Let $(E, \phi)$ be a Higgs bundle. We first choose a hermitian metric $h$ on $E$ which induces a Chern connection $\nabla_h$. The Chern connection will likely not be flat so we modify it by the Higgs field, $\nabla' := \nabla_h + \phi$. Computing the curvature gives,
\[ F_{\nabla'} = F_{\nabla_h} + \nabla \phi + \phi \wedge \phi \]

\section{Moduli Spaces of Vector Bundles and Higgs Bundles}

\newcommand{\Isom}{\mathrm{Isom}}

From now on let $S$ be a base scheme (the only important case this quarter will be $S = \Spec{\CC}$ but we may talk about $S = \Spec{\Q_p}$ or $\Spec{\FF_p}$ next quarter).

\begin{defn}
Let $X$ be an $S$-scheme and $r$ an integer. Then let $\M(X, r)$ be the stack fibered in groupoids over $\Sch_S$ with,
\begin{enumerate}
\item objects are pairs $(T, \E)$ where $T$ is an $S$-scheme and $\E$ is a vector bundle over $X_T$ of rank $r$ flat over $T$ (flatness is automatic if $X \to S$ is flat)
\item morphisms are pairs $(f, \alpha) : (T, \E) \to (T', \E')$ of a morphism $f : T \to T'$ over $S$ and an isomophism $\alpha : (\id \times f)^* \E' \iso \E$.
\end{enumerate} 
\end{defn}

\begin{theorem}
If $X \to S$ is proper and of finite presentation then $\M(X, r)$ is an algebraic stack locally of finite presentation over $S$ with affine diagonal of finite presentation.
\end{theorem}

\renewcommand{\Coh}{\mathbf{Coh}}

\begin{proof}
In the stacks project the stack $\Coh_{X/S}$ of all coherent sheaves is consered for $X \to S$ finitely presented. This is the stack fibered in groupoids over $\Sch_S$ with,
\begin{enumerate}
\item objects are pairs $(T, \F)$ where $T$ is an $S$-scheme and $\F$ is a quasi-coherent $\struct{X_T}$-module of finite presentation, flat over $T$, with support proper over $T$
\item morphism are pairs $(f, \alpha) : (T, \F) \to (T', \F')$ with $f : T \to T'$ and $\alpha : (\id \times f)^* \F' \iso \F$.
\end{enumerate}
A few remarks: we just require $\F$ to be of finite presentation rather than coherent (these are equivalent over noetherian test schemes) because it is preserved under base change. The properness condition is necessary for the automorphisms to be finite-dimensional\footnote{For example the stack $\X$ of all vector bundles of rank $r$ on $\A^1$ does not form an algebraic stack because it is limit-preserving since the a vector bundle on $(\ilim T_i) \times \A^1$ in an inverse system of affine schemes $\{ T_i \}$ is defined over some $T_i \times \A^1$ and the morphisms are given by the colimit by spreading out. Therefore, by Tag~\chref{https://stacks.math.columbia.edu/tag/0CXI}{0CXI} if $\X$ were algebraic then $\Delta_{\X}$ would be representable by locally finite type algebraic spaces hence the isomorphism schemes would be finite dimensional. However, the infinitesimal automorphisms of $\struct{X}$ on $\A^1$ is infinite dimensional.}
The stacks project (e.g. Tag~\chref{https://stacks.math.columbia.edu/tag/09DS}{09DS}) checks Artin's axioms to prove that $\Coh_{X/S}$ is an algebraic stack over $S$ if $X \to S$ is separated and of finite presentation.
\bigskip\\
Now $\M(X, r) \subset \Coh_{X/S}$ is an open substack when $X \to S$ is additionally universally closed. Indeed, since $\F$ is flat over $T$ local freeness can be checked on fibers hence we just need to show that the locus on $T$ where $\F$ is locally free on the fiber is open and indeed since the locus where $\F$ on $X_T \to T$ is a vector bundle of rank $r$ is open on $X_T$ the locus on $T$ is open since the $X_T \to T$ is closed.
\bigskip\\
Moreover, $\Coh_{X/S} \to S$ is locally of finite presentation because it is limit preserving (one of Artin's axioms) which one shows via spreading out vector bundles. The diagonal is affine and finitely presented because the isom space,
\[ \Isom(\F, \G) : T/S \mapsto \Isom_{T}(\F_T, \G_T) \]
between fintely presented $\struct{X}$-modules is representable by a scheme affine and of finite presentation over $T$ (see Tag~\chref{https://stacks.math.columbia.edu/tag/08K9}{08K9}).
\end{proof}

Now we want to discuss the moduli of vector bundles with connections. We need the notion of a relative connection.

\begin{defn}
Let $f : X \to S$ be a morphism of schemes. Then an $S$-connection on a vector bundle $\E$ over $X$ is an $f^{-1} \struct{S}$-linear map,
\[ \nabla : \E \to \Omega^1_{X/S} \ot \E \]
satisfying the Leibnitz rule. The $f^{-1} \struct{S}$-linearity is automatic from the form of the Leibnitz law and the definition of $\Omega_{X/S}$.
\end{defn}

\begin{defn}
Let $\M_{\dR}(X, r)$ be the stack fibered in groupoids over $\Sch_S$ with,
\begin{enumerate}
\item objects are $(T, \E, \nabla)$ where $T$ is an $S$-scheme and $\E$ is a vector bundle over $X_T$ of rank $r$ flat over $T$ and $\nabla$ is a flat $T$-connection on $\E$
\item morphisms $(f, \alpha) : (T, \E, \nabla) \to (T', \E', \nabla')$ are pairs $f : T \to T'$ and $\alpha : (\id \times f)^* \E' \iso \E$ an isomorphism such that,
\begin{center}
\begin{tikzcd}
(\id \times f)^* \E' \arrow[d, "\alpha"] \arrow[r, "\nabla'"] &  (\id \times f)^* \E' \ot \Omega_{X_T/T}^1 \arrow[d, "\alpha \ot \id"] 
\\
\E \arrow[r, "\nabla"] & \E \ot \Omega^1_{X_T/T}
\end{tikzcd}
\end{center}
commutes\footnote{Given a morphism $f : X \to Y$ and a vector bundle $(\E, \nabla)$ with connection on $Y$ there is a pullback connection $(f^* \E, f^* \nabla)$ defined as the unique connection such that $(f^* \nabla) (f^* s) = f^* (\nabla s)$ }
\end{enumerate}
\end{defn}

\renewcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}

\begin{lemma}
Let $f : \X \to \Y$ be a morphism of algebraic stacks over $S$. Suppose that $\cP$ is a property of morphisms of algebraic stacks such that,
\begin{enumerate}
\item $\cP$ is preserved under base change and composition
\item $\cP$ holds for $f$
\item $\cP$ holds for $\Delta_{\Y/S}$
\end{enumerate}
then $\cP$ holds for $\Delta_{\X/S}$.
\end{lemma}

\begin{proof}
Consider the diagram,
\begin{center}
\begin{tikzcd}
\X \arrow[d, "f"] \arrow[r, "\Delta_{\X/S}"] & \X \times_S \X \arrow[d, "f \times f"]
\\
\Y \arrow[r, "\Delta_{\Y/S}"] & \Y \times_S \Y
\end{tikzcd}
\end{center}
Then factoring $\Delta_{\X/S}$ via the graph we see that $\Delta_{\X/S}$ is the composition of the base change of the diagonal of $f \times f$ and the base change of $(\Delta_{\Y/S} \circ f)$ all of which satisfy $\cP$.
\end{proof}

\begin{prop}
Let $X \to S$ be proper and of finite presentation with $\Omega^1_{X/S}$ flat over $S$ (e.g. if $X \to S$ is smooth). Then $\M_{\dR}(X, r)$ is an algebraic stack lfp over $S$ with affine diagonal.
\end{prop}

\begin{proof}
We will show that the forgetful map $\M_{\dR}(X, r) \to \M(X, r)$ is affine and finite presentation (in particular representable). Then any smooth presentation of $\M(X,r)$ gives a smooth presentation of $\M_{\dR}(X, r)$ by base change. Then we apply the lemma with $\cP$ being ``affine and locally of finite presentation'' to the map $\M_{\dR}(X, r) \to \M(X, r)$. 
\bigskip\\
We need to show that for any test scheme $T \to \M(X, r)$ that $\M_{\dR}(X, r) \times_{\M(X, r)} T \to T$ is affine and of finite presentation. Indeed the test map fixes a vector bundle $\E$ on $X_T$ of rank $r$ and we need to consider the functor,
\[ T'/T \mapsto \{ \nabla \text{ integrable } T'\text{-connection on } \E_{T'} \} \]
To understand this, recall that $T'$-connections on $\E_{T'}$ correspond to sections of the sequence,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & \E_{T'} \ot \Omega^1_{X_T'/T'} \arrow[r] & \cP^1_{X/S}(\E)_{T'} \arrow[r] & \E_{T'} \arrow[r] & 0
\end{tikzcd}
\end{center}
where $\nabla = j - \sigma$. Therefore, the integrable connections correspond to the pullback along,
\[ \Hom{T'}{\E_{T'}}{\cP^1_{X/S}(\E)_{T'}} \to \Hom{T'}{\E_{T'}}{\E_{T'} \ot \Omega^2_{X'_T/T'}} \times \Hom{T'}{\E_{T'}}{\E_{T'}} \]
of the section $(0, \id)$ (note the curvature map is nonlinear). Furthermore, these sheaves are all pulled back along $X_{T'} \to X_T$. Since the pullback of a section induces the pullback connection and $f^* F_{\nabla} = F_{f^* \nabla}$ so this is a map of sheaves. Then the functor is the pullback along,
\[ \Hom{}{\E}{\cP^1_{X/S}(\E)_{T}} \to \Hom{}{\E}{\E \ot \Omega^2_{X_T/T}} \times \Hom{}{\E}{\E} \]
but since these sheaves are finitely presented (since $X \to S$ is finitely presented), flat over $T$, and with proper support over $T$ these functors are representable by schemes (Tag~\chref{https://stacks.math.columbia.edu/tag/08K6}{08K6}) affine and finitely-presented over $T$ hence so is the pullback of $T$ along this map since the map is also affine and finitely presented.
\end{proof}

\begin{rmk}
Taking moduli of relative connections is necessary if we want $\M_{\dR}$ to even be a stack! Indeed, the functor of all connections on $\E$ does not satisfy the fppf sheaf condition. Indeed this is for the same reason that $T \mapsto H^0(T, \Omega_T)$ is not a sheaf in the fppf topology in positive characteristic (it is a sheaf for the \etale and hence smooth topology). Interestingly in characteristic zero it is a sheaf in the $h$-topology restricted to smooth scheemes but not in general. However, more problematically $T \mapsto H^0(T, \Omega_T)$ is never representable. Indeed, the functor is limit preserving so its representing object would have to be finite type but it has exactly one closed point (lets work with the case $S = \Spec{\CC}$) but it has nontrivial maps from $\A^1$ so it cannot be represented by an Artin ring. 
\end{rmk}

Now we consider the moduli problem of $t$-connections. There are two ways one might approach this that boil down to the question: should the $k$-points of this moduli space allow for $t$ to be a function or should it take on a constant value e.g. if $X$ is a $t$-scheme over $k$ we could imagine a $k$-point corresponds to a $t$-connection over $X$. This is not what we want because it does equip our moduli space with a fibration over $\A^1$. Instead, we will let the $t$-scheme structure arise from the test scheme so the stack will be fibered over the category of $t$-schemes i.e. $\Sch_{\A^1_S}$. Categorically, this amounts to nothing more than chaning our base scheme from $S$ to $\A^1_S$. Then we can define the moduli problem.


\begin{defn}
Let $\M_{\Hod}(X, r)$ be the stack fibered in groupoids over $\Sch_{\A^1_S}$ with,
\begin{enumerate}
\item objects are $(T, \E, \nabla)$ where $T$ is an $\A^1_{S}$-scheme and $\E$ is a vector bundle over $X_T$ of rank $r$ flat over $T$ and $\nabla$ is a flat $t$-connection on $\E$ relative to $T$
\item morphisms $(f, \alpha) : (T, \E, \nabla) \to (T', \E', \nabla')$ are pairs $f : T \to T'$ and $\alpha : (\id \times f)^* \E' \iso \E$ an isomorphism such that,
\begin{center}
\begin{tikzcd}
(\id \times f)^* \E' \arrow[d, "\alpha"] \arrow[r, "\nabla'"] &  (\id \times f)^* \E' \ot \Omega_{X_T/T}^1 \arrow[d, "\alpha \ot \id"] 
\\
\E \arrow[r, "\nabla"] & \E \ot \Omega^1_{X_T/T}
\end{tikzcd}
\end{center}
commutes\footnote{Given a morphism $f : X \to Y$ and a vector bundle $(\E, \nabla)$ with connection on $Y$ there is a pullback connection $(f^* \E, f^* \nabla)$ defined as the unique connection such that $(f^* \nabla) (f^* s) = f^* (\nabla s)$ }
\end{enumerate}
\end{defn}

\begin{rmk}
Because the $t$-parameter arises from a map $T \to \A^1$ and the $t$-connection is relative to $T$ we treat $t$ like a constant when applying $\nabla$ there is no $\d{t}$ term that appears.
\end{rmk}

\begin{prop}
Let $X \to S$ be proper and of finite presentation with $\Omega^1_{X/S}$ flat over $S$ (e.g. if $X \to S$ is smooth). Then $\M_{\Hod}(X, r)$ is an algebraic stack lfp over $S$ with affine diagonal.
\end{prop}

\begin{proof}
As before, we will show that the forgetful map $\M_{\Hod}(X, r) \to \M(X, r) \times \A^1_S$ is affine and finite presentation (in particular representable). 
We need to show that for any test $t$-scheme $T \to \M(X, r)$ that $\M_{\dR}(X, r) \times_{\M(X, r)} T \to T$ is affine and of finite presentation. Indeed this fixes the data $(T, t, \E)$ where $\E$ is a vector bundle on $X_T$ of rank $r$ and $t : T \to \A^1_S$. We need to show that the functor,
\[ T'/T \mapsto \{ \nabla \text{ integrable } t\text{-connection on } \E_{T'} \text{ over } T' \} \]
is representable. To understand this, check that $t$-connections on $\E_{T'}$ over $T'$ correspond not to sections of,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & \E_{T'} \ot \Omega^1_{X_T'/T'} \arrow[r] & \cP^1_{X/S}(\E)_{T'} \arrow[r] & \E_{T'} \arrow[r] & 0
\end{tikzcd}
\end{center}
but to maps $\sigma$ such that $\pi \circ \sigma = t$ is the multiplication by $t$ map 
where we set $\nabla = t \cdot j - \sigma$.  Therefore, the integrable connections correspond to the pullback along,
\[ \Hom{T'}{\E_{T'}}{\cP^1_{X/S}(\E)_{T'}} \to \Hom{T'}{\E_{T'}}{\E_{T'} \ot \Omega^2_{X'_T/T'}} \times \Hom{T'}{\E_{T'}}{\E_{T'}} \]
of the section $(0, t)$. Furthermore, these sheaves are all pulled back along $X_{T'} \to X_T$. Since the pullback of a section induces the pullback connection and $f^* F_{\nabla} = F_{f^* \nabla}$ so this is a map of sheaves. Therefore the functor is the pullback along,
\[ \Hom{}{\E}{\cP^1_{X/S}(\E)_{T}} \to \Hom{}{\E}{\E \ot \Omega^2_{X_T/T}} \times \Hom{}{\E}{\E} \]
but since these sheaves are finitely presented (since $X \to S$ is finitely presented), flat over $T$, and with proper support over $T$ these functors are representable by schemes (Tag~\chref{https://stacks.math.columbia.edu/tag/08K6}{08K6}) affine and finitely-presented over $T$ hence so is the pullback of $T$ along this map since the map is also affine and finitely presented.
\end{proof}

\begin{rmk}
Alternatively, we could descrbie $t$-connections  as sections of the sequence obtained by pulling back along $\E_{T'} \xrightarrow{t} \E_{T'}$,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & \E_{T'} \ot \Omega^1_{X_T'/T'} \arrow[r] & \cP^{t}_{X/S}(\E)_{T'} \arrow[r] & \E_{T'} \arrow[r] & 0
\end{tikzcd}
\end{center}
where explicitly $\cP^{t}_{X/S}(\E)_{T'}$ is the kernel of $\cP^1_{X/S}(\E)_{T'} \oplus \E_{T'} \to \E_{T'}$ via $\pi - t$ so that a section of this new sequence is a map $\sigma : \E_{T'} \to \cP^1_{X/S}(\E)_{T'}$ and a map $\lambda : \E_{T'} \to \E_{T'}$ so that $(\sigma, \lambda)$ is a section meaning that $\lambda = \id$ and that lands in $\cP^{t}_{X/S}(\E)_{T'}$ meaing $\pi \circ \sigma = t$. Under this interpretation we we need to consider the pullback of $(0, \id)$ along,
\[ \Hom{}{\E}{\cP^t_{X/S}(\E)_{T}} \to \Hom{}{\E}{\E \ot g^* \Omega^2_{X/S}} \times \Hom{}{\E}{\E} \]
but why is the first representable? We need to show that $\cP^t_{X/S}(\E)$ is finitely presented and flat over $S$ (we already know its support is proper over $S$. It is not generally true that the kernel of a surjection between finitely-presented modules is finitely-presented. However, this is true if the quotient is flat since then the sequence is locally split (using that finitely presented flat modules are projective).
\end{rmk}

\subsection{Framed Moduli}

For reprsentations $\pi \to \GL_r(\CC)$ we often instead consider the moduli space of \textit{framed representations} meaning without moding out by conjugation (not taking maps up to isomorphism but rather just the set of group homomorphisms). This has the advantange of have a moduli problem representable by a scheme rather than a stack. Note, when $\pi = \pi_1(X(\CC))$ we need to pick a basepoint $x \in X$ since otherwise this group is only defined up to conjugation so the set of maps is not well-defined.
\bigskip\\
This framing for reprsentations of $\pi_1$ corresponds to \textit{framed local systems} meaning local systems $\L$ equipped with an isomorphism $\varphi : \L_x \iso \CC^r$. As long as $X$ is connected, this rigidifies the problem since $\Hom{}{\L}{\L'} \embed \Hom{}{\L_x}{\L_x'}$ is injective because the sheaves are locally constant. 

\begin{defn}
$M_B^{\square}(X, x, r)$ is the moduli space of framed local systems of rank $r$ or equivalently framed representations of $\pi_1(X(\CC), x)$.
\end{defn}

\begin{prop}
$M_B^{\square}(X, x, r)$ is an affine scheme finite type over $\CC$.
\end{prop}

\begin{proof}
Since $X(\CC)$ is a finite CW complex we know that $\pi_1(X(\CC))$ is a finitely presented group. For any finitely presented group $G$, let $\{ g_i \}_{1 \le i \le n}$ be a set of generators. Then the framed character variety is exactly the closed subscheme of $(\GL_r)^n$ cut out by the relations. 
\end{proof}

Now we can likewise define the moduli spaces of framed vector bundles Higgs bundles. However, there is a subtlty which is that, in general, a framing does not adequately rigidify the problem in order to obtain a fine moduli space representable by a scheme.

\begin{example}
For a simple example, let $X = \P^1$ and $\E = \struct{}(-1) \oplus \struct{}(1)$ and let $\phi = 0$ be a trivial Higgs field. Then,
\[ \End{\E, \phi} = \left \{ \begin{pmatrix}
\CC & \Hom{}{\struct{}(-1)}{\struct{}(1)}
\\
0 & \CC
\end{pmatrix} \right\} \]
Thus, for example the automorphism,
\[ \varphi = \begin{pmatrix}
1 & X^2_0
\\
0 & 1
\end{pmatrix} \]
is the identity at $\infty = [0 : 1]$ and hence is compatible with a framing. We see the problem is $\E$ is not polystable.
\end{example}

However, the same behavior does not happen for vector bundles with connection.

\begin{prop}
Let $X$ be a smooth connected variety over $\CC$. Let $(\E, \nabla)$ be a vector bundle with connection and $\varphi : \E \to \E$ a parallel automorphism. If $\varphi_x = \id$ then $\varphi = \id$.
\end{prop}

\begin{proof}
Indeed, $\nabla$ induces a connection on $\Hom{}{\E}{\E}$ defined by the rule that,
\[ (\nabla \varphi)(s) = \nabla \varphi(s) - \varphi(\nabla s) \]
and by definition we have $\nabla \varphi = 0$. Therefore, $\varphi$ and $\id$ are both flat sections of $\Hom{}{\E}{\E}$. We will show that the locus where $\varphi$ and $\id$ are equal is both open and closed. Closedness is clear. To prove openness we use the uniqueness of solutions to first-order ODEs. We need to show that given a vector bundle with connection $(\E, \nabla)$ that the locus where two flat sections $s_1, s_2$ agree is open. Shrink so that we are on a disk $D^n \subset \CC^n$ and $\E \cong \struct{}^r$ then the connection takes the form,
\[ \nabla = \d + A \]
where $A$ is an $r \times r$ matrix of $1$-forms. Now $s_1$ and $s_2$ two solutions to the system of first-order ODEs so if they are equal at a point then they are equal on the disk.  
\end{proof}

(CAN THIS HAPPEN FOR SINGULAR VARITIES?)

\subsection{Stability Conditions}

\begin{lemma}
Let $\E_1$ and $\E_2$ be semistable vector bundles (or Higgs bundles)
\begin{enumerate}
\item if $\mu(\E_1) > \mu(\E_2)$ then $\Hom{X}{\E_1}{\E_2} = 0$
\item if $\mu(\E_1) \ge \mu(\E_2)$ and $\E_2$ is stable then any nonzero $\varphi \in \Hom{X}{\E_1}{\E_2}$ is surjective
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\varphi : \E_1 \to \E_2$ and let $\K$ and $\F$ be the kernel and image respectively. In the case of Higgs bundles, these are $\phi$-stable subsheaves. Since $\E_1$ is semistalbe $\mu(\K) \le \mu(\E_1)$ hence,
\begin{align*}
\mu(\F) \rank{\F} &= \mu(\E_1) \rank{\E_1} - \mu(\K) \rank{\K} 
\\
& \ge \mu(\E_1) \rank{\E_1} - \mu(\E_1) \rank{\K}
\\
& = \mu(\E_1) \rank{\F}
\end{align*}
hence either $\F$ is zero or has positive rank in which case $\mu(\F) \ge \mu(\E_1)$. For (a) we would have $\mu(\F) \ge \mu(\E_1) > \mu(\E_2)$ contradicting the semistability of $\E_2$. For (b) we would have $\mu(\F) \ge \mu(\E_1) \ge \mu(\E_2)$ contradicting the stability of $\E_1$ unless $\F = \E_1$ meaning $\varphi$ is surjective.
\end{proof}

\begin{cor}

\end{cor}

\subsection{Coarse Spaces}

\subsubsection{GIT}

\newcommand{\Set}{\mathbf{Set}}

\begin{defn}
Let $X^{\sharp} : \Sch_S^\op \to \Set$ be a functor. A pair $(X, \varphi)$ of a scheme $X \in \Sch_S$ and a map of functors $\varphi : X^{\sharp} \to X$ \textit{coarse represents} (or corepresents) the functor $X^\sharp$ if it is initial for all such pairs. Explicitly, given any other $f : X^{\sharp} \to Y$ it factors uniquely as $f = f' \circ \varphi$,
\begin{center}
\begin{tikzcd}
X^{\sharp} \arrow[r, "\varphi"] \arrow[rd, "f"] & X \arrow[d, dashed, "f'"]
\\
& Y
\end{tikzcd}
\end{center}
If it exists, this uniquely determines the pair $(X, \varphi)$ up to unique isomorphism.
\bigskip\\
Moreover, we say that $(X, \varphi)$ univeraly coarse represents $X^\sharp$ if for each map of $S$-schemes $X' \to X$ then $\varphi' : X^{\sharp} \times_X X' \to X'$ is a initial (it coarse represents $X^{\sharp} \times_X X'$).
\end{defn}


\begin{example}
Let $X$ be a scheme with a $G$-action where $G$ is an $S$-group. Let $Y^\sharp(T) = X(T)/G(T)$. Then categorical quotients $X \to Y$ correspond exactly to coarse representing objects $Y^{\sharp} \to Y$. Indeed, this claim will imediately follow from the identification of morphisms $\varphi : Y^\sharp \to Y$ with $G$-invariant morphisms $X \to Y$. But morphisms $\varphi : Y^\sharp \to Y$ are maps natural transformations $X(T) \to Y(T)$ which factor through $X(T) \to X(T)/G(T)$ meaning that $X(T) \to Y(T)$ is $G(T)$-invariant. This is equvialent to $G$-invariance of $X \to Y$.
\end{example}

\begin{rmk}
Note that $f : X \to Y$ is $G$-invariant if the diagram,
\begin{center}
\begin{tikzcd}
G \times X \arrow[d, "\rho"]\arrow[r, "\pi_2"] & X \arrow[d, "f"]
\\
X \arrow[r, "f"] & Y
\end{tikzcd}
\end{center}
commutes. This is equivalent to $X(T) \to Y(T)$ is a $G(T)$-invariant map of sets. Indeed, the diagram shows that for any $g \in G(T)$ and $x \in X(T)$ we see that $f(g \cdot x) = f(x)$ from commutativity. Conversely, to from this diagram we consider $X(G \times X) \to Y(G \times X)$ which must be $G(G \times X)$-invariant. This means that $f(\pi_1 \cdot \pi_2) = f(\pi_2)$ but $\pi_1 \cdot \pi_2 = \rho$ as a map $G \times X \to X$ and hence we get $f \circ \rho = f \circ \pi_2$ as desired.
\end{rmk}

Let $S = \Spec{k}$ with $k$ algebraically closed of characteristic zero and $G$ be a reductive group.

\begin{defn}
The morphism $\varphi : X \to Y$ is a \textit{good quotient} if it is a universal categorical quotient (the associated $Y^\sharp \to Y$ universally coarse represents $Y^\sharp$), affine, and $Y$ is quasi-projective.
\end{defn}

\begin{theorem}[Mumford]
Suppose $\varphi : X \to Y$ is a good quotient. If $V_1, V_2$ are two distinct $G$-invariant closed subsets of $X$ then $\varphi(V_1)$ and $\varphi(V_2)$ are disjoint. The closed points $x \in Y$ correspond to closed orbits of $X$. If $x \in X$ is a closed point, its image is the point $y$ corresponding to the (unique) closed orbit in the closure of the orbit of $z$. 
\end{theorem}

Suppose that $G \acts X$ and $\L$ is an invertible sheaf on $X$ with $G$-action. 

\begin{defn}
A point $x \in X$ is \textit{semistable} if there exists a $G$-invariant section $f \in H^0(X, \L^{\ot n})^G$ such that $f(x) \neq 0$ and $D(f)$ is affine. A point $x \in X$ is \textit{stable} if furthermore we can find $f$ such that the orbits of $G \acts D(f)$ are all closed in $D(f)$ and the stabilizer of $x$ is finite. We call these loci,
\[ X^s \subset X^{ss} \subset X \]
\end{defn}

\begin{prop}
With the above notation. There exists a good quotient $\varphi : X^{ss} \to Y$ and an open set $Y^s \subset Y$ such that $\varphi^{-1}(Y^s) = X^s$ and the quotient $Y^s = Z^s / G$ is a universal geometric quotient. There is an ample invertible sheaf $\L_Y$ on $Y$ (it is always quasi-projective by definition) with $\varphi^* \L_Y = \L$. If $X$ is projective and $\L$ is ample, then $Y$ is projective. 
\end{prop}

Conversely, if $\varphi : X \to Y$ is a good quotient, then choose an ample $\L_Y$ on $Y$ and set $\L = \varphi^* \L_Y$ which comes equipped with a $G$-action. Running the procedure to $(X, \L)$ we obtain $X = X^{ss}$ and recover $\varphi : X \to Y$.

\subsubsection{The Betti Moduli Space}

Let $\Gamma$ be a finitely generated group and fix $r$.
\bigskip\\
We say that two $\Gamma$-representations are Jordan equivalent if their \textit{semisimplifications} are isomorphic. The semisimplification is the associated graded representation corresponding to any composition series. This is independent of the representation by the Jordan-Holder theorem.


\begin{thm}[Mumford, Seshadri]
There exists a universal categorical quotient $\mathbf{R}(\Gamma, r) \to \mathbf{M}(\Gamma, r)$ by the conjugation action of $\GL_r$. Then $M(\Gamma, r)$ is an affine scheme of finite type over $k$ whose closed points represent Jordan equivalence classes of representations.
\end{thm}

Hence we apply this to produce,
\[ M^\square_B(X, x, r) \to M_B(X, r) \]
the coarse space of representations. In this case, it is the coarse space of the stack quotient,
\[ \M_B = [M^\square_B(X, x, r) / \GL_r] \]

\subsubsection{The Moduli Space of Higgs Bundles}



\section{Clarifications and Examples}

\begin{rmk}
[Thank Matt] I described $\M_{\Hod}(X, r)$ as parametrixing pairs $(\E, \nabla)$ of a vector bundle of rank $r$ on $X \times \A^1$ and a $t$-connections $\nabla$ on $\E$ for $\pi_2 : X \times \A^1 \to \A^1$. This was misleading, I was actually describing sections of $\M_{\Hod} \to \A^1$ since those should be the objects which interpolate between the $t = 0$ and $t = 1$ fibers. Since we want a map $\M_{\Hod}(X, r) \to \A^1$ we can see that $\M_{\Hod}(X, r)$ should be valued on $\A^1$-schemes. Thus, I didn't mean to describe the stack sending $T$ to vector bundles on $X \times \A^1 \times T$ with $t$-connection for the map to $\A^1_T$. This stack does not have an obvious map to $\A^1$. Indeed, this fibered category is $\M_{\Hod}(X)(\A^1_T)$ rather than $\M_{\Hod}(X)(T)$ meaning this stack is the Weil restriction of $\M_{\Hod}(X) \to \A^1_S$ along $\A^1_S \to S$.
\bigskip\\
Likewise, I said that a $t$-connection $\nabla$ on $\pi_1^* \E$ for $t : X \times \A^1 \to \A^1$ the $t$-coordinate where $\E$ a vector bundle on $X$ is the correct notion of a degeneration of a connection to a Higgs bundle on a \textit{fixed} underlying vector bundle $\E$. In our formalism the space of such degenerations is nicely described as the sections of $M_{\Hod}(X, \E) \to \A^1_S$ where $M_{\Hod}(X, \E)$ is the \textit{scheme},
\begin{center}
\begin{tikzcd}
M_{\Hod}(X, \E) \arrow[r] \arrow[d] \pullback &  \A^1_S \arrow[d, "{[\E]}"]
\\
\M_{\Hod}(X, r) \arrow[r] & \M(X,r) \times_S \A^1_S
\end{tikzcd}
\end{center}
\end{rmk}

\subsection{Endomorphisms of Vector Bundles}

About the question of endomorphisms of semistable vector bundles. We want to show the following:

\begin{prop}
Let $\E, \E'$ be semistable Higgs (resp. vector) bundles with $\mu(\E) \ge \mu(\E')$ and let $x \in X$ then the map,
\[ \Hom{X}{\E}{\E'} \to \Hom{}{\E(x)}{\E'(x)} \]
is injective.
\end{prop}

\begin{proof}
We first prove this in the case that $\E'$ is stable. We showed that any nonzero $\varphi \in \Hom{X}{\E}{\E'}$ is surjective. Thus if $\varphi_x = 0$ then $\varphi = 0$. Now we prove the general case by induction on $\rank{\E'}$. If $\E'$ is not stable then we can filter it by a composition series (the Jordan-H\"{o}lder filtration). Really all we need is a sequence of vector bundles,
\[ 0 \to \E'_1 \to \E' \to \E'_2 \to 0 \] 
with $\E'_1$ stable and $\E'_2$ semistable all of slope $\mu(\E')$. Then we get,
\begin{center}
\begin{tikzcd}
0 \arrow[r] & \Hom{}{\E}{\E'_1} \arrow[d, hook] \arrow[r] & \Hom{}{\E}{\E'} \arrow[d] \arrow[r] & \Hom{}{\E}{\E_2'} \arrow[d, hook]
\\
0 \arrow[r] & \Hom{}{\E(x)}{\E'_1(x)} \arrow[r] & \Hom{}{\E(x)}{\E'(x)} \arrow[r] & \Hom{}{\E(x)}{\E_2'(x)} 
\end{tikzcd}
\end{center}
the outside maps are injective by the induction hypothesis so we conclude by a diagram chase.
\end{proof}

\newcommand{\sat}{\mathrm{sat}}
\newcommand{\LF}{\mathrm{LF}}

However, we swept something under the rug. It it true by Zorn's lemma that if $\E'$ is not stable then there exists a minimal subsheaf $\F$ of slope $\mu(\F) = \mu(\E')$ so $\F$ is stable. However, there is no reason this is a sub-bundle. We can replace $\F$ by $\F^{\sat}$ (the the kernel of $\E' \to (\E'/\F)_{\text{tors-free}}$) which has $\mu(\F^{\sat}) \ge \mu(\F)$. If $X$ is a curve then any torsion-free sheaf is locally free and hence $\F^{\sat}$ is a subbundle. Therefore, if $X$ is a curve we only need to consider subbundles to check (semi)-stability and there is a Jordan-H\"{o}lder filtration by subbundles.
\bigskip\\
For $\dim{X} > 1$ the Jordan-H\"{o}lder and Hardar-Narashimhan filtrations are only by torsion-free subsheaves. In order to get a rigidified fine moduli space, Simposon makes the following definition which we state in the relative setting: for $X \to S$ smooth projective with a section $\xi$ we say $\E$ satisfies $\LF(\xi)$ if its Jordan-H\"{o}lder subquotients are locally free along $\xi$. 

\begin{prop}
Let $\E, \E'$ be semistable Higgs (resp. vector) bundles satisfying $\LF(\xi)$ and $\mu(\E) \ge \mu(\E')$ then the map,
\[ \Hom{X}{\E}{\E'} \to \Hom{S}{\xi^* \E}{\xi^* \E'} \]
is injective.
\end{prop}

\subsection{A striking example}

We have mentioned over and over that the moduli spaces $M_B$ and $M_{\dR}$ are only biholomorphic 
\textit{not algebraically isomorphic} and these are only homeomorphic to $M_{\Dol}$. I want to give a striking example.
\bigskip\\
Let $E$ be an elliptic curve. Let $r = 1$ so we are looking for line bundles with connection and characters of $\pi_1(E) = \Z^2$. Clearly $M_B = \Gm^2$ and since $\pi_1(E)$ does not know about the complex structure of $E$ we see that $M_B$ does not know ``which elliptic curve'' $E$ is.
\bigskip\\
However, any $(\L, \nabla)$ must have $c_1(\L) = 0$ since the Atyiah class (obstruction to having an algebraic connection) for rank $1$ vector bundles is just $c_1(\L) \in H^1(X, \Omega^1)$ giving $M_{\dR} \to \fPic^0_E = E$. Since the space of connections on $\L$ is affine over $H^0(E, \Omega_E^1) = \CC$, the map is an $\A^1$-torsor trivial in the \etale topology (its smooth so has \etale sections Therefore, by the ``homotopy invariance'' for line-bundles $\fPic_{M_{\dR}}^0 = E$ so $M_{\dR}$ knows everything about the elliptic curve! However, $M_{\dR}^\an \cong M_B^\an = (\CC^\times)^2$ loses all this information!
\bigskip\\
This is actually a really cool example. Since we can send $(\L, \nabla), (\L', \nabla') \mapsto (\L \ot \L', \nabla \ot \nabla')$ this makes $M_{\dR} \to E$ a map of algebraic groups and, in accordance with Chevallay's theorem, there is an exact sequence,
\[ 0 \to \Ga \to M_{\dR} \to E \to 0 \]
However, if $M_{\dR}$ were affine then it would be an affine algebraic group which we know means it would be linear algebraic. Chevallay proved every quotient of a linear algebraic group is linear algebraic giving a contradiction. Hence $M_{\dR}$ is a non-affine scheme such that $M_{\dR}^\an$ is Stein. In fact, $M_{\dR}$ has no nonconstant algebraic functions even though it can be holomophically embedded in affine space.
\bigskip\\  
Let's understand how there is such a biholomorphism. We can write $E = \CC / \left< q \right>$ for some $q \in \CC^\times$. Then we get $M_{\dR}$ 
\bigskip\\
Even worse, $M_{\Dol} = \fPic^0_{E} \times H^0(E, \Omega^1_E) = E \times \A^1$ which is not analytically isomorphic to $(\CC^\times)^2$ since the latter is Stein but not the former (since $H^1(X, \struct{X}) \neq 0$). Alternatively, there is an embedding $E \embed E \times \CC$ but every holomorphic map $E \to (\CC^\times)^2$ is constant by the maximum principle. In this case the Simpson correspondence is given as follows, write $\CC^\times = S^1 \times \RR^+$ and then we have homeomorphisms,
\[ E \times \CC \cong (S^1)^2 \times (\RR^+)^2 \cong (\CC^\times)^2 \]
If we write out what happens in detail, fixing a homology basis $\gamma_1, \gamma_2$ we will find that $E \times \{ 0 \}$ corresponds to unitary representations so we send $x \in E$ to the monodromy of the unique harmonic connection on $\struct{}(x - 0)$ around $\gamma_1$ and $\gamma_2$ and the Higgs field is mapped to $(\RR^+)^2$ via,
\[ \theta \mapsto \left( \exp\left( - \int_{\gamma_1} \theta + \bar{\theta} \right), \exp\left( - \int_{\gamma_2} \theta + \bar{\theta} \right) \right) \] 
which are positive real numbers since the interior integrals are over real forms.

\section{$p$-Stability and $\mu$-Stability}

From now on, let $X$ be a smooth projective scheme of dimension $d$ over $S = \Spec{\CC}$ with very ample line bundle $\struct{X}(1)$. We write the ample class $H$ on $X$. Then recall the slope is,

\begin{defn}
Recall that the slope of a torsion-free sheaf is,
\[ \mu(\E) := \frac{c_1(\E) \cdot H^{n-1}}{\rank{\E}} \]
\end{defn}

\newcommand{\Td}{\mathrm{Td}}
\renewcommand{\ch}{\mathrm{ch}}

\begin{rmk}
Recall that HRR allows us to compute,
\[ \chi(X, \E(\ell)) = \int \ch(\E(\ell)) \Td(X) = \int \ch(\E) (e^{\ell H}) \Td(X) \]
This is a polynomial in $\ell$. Let's compute the terms of order $\ell^d$ and $\ell^{d-1}$. We have,
\[ \ch(\E) = r + c_1(\E) + \cdots \quad \quad \Td(X) = 1 + \tfrac{1}{2} c_1(X) + \cdots \]
Also,
\[ e^{\ell H} = 1 + \ell H + \cdots + \tfrac{1}{d!} \ell^n H^d \]
The term $\ell^d H^d$ can only pair againt $0$-forms and the term $\ell^{d-1} H^{d-1}$ can only pair against $1$-forms. There are two such terms: $c_1(\E) \cdot 1$ and $r \cdot \tfrac{1}{2} c_1(X)$ and thus,
\[ \chi(X, \E(\ell)) = r \ell^d/d! + [c_1(\E)\cdot H^{d-1} + \tfrac{1}{2} r c_1(X) \cdot H^{d-1}] \ell^{d-1}/(d-1)! + \cdots \]
Hence if we write the Hilbert polynomial of $\E$ as,
\[ p(\E) = r \ell^d / d! + a \ell^{d-1} / (d-1)! + \cdots \]
we identify $a = [c_1(\E) + \tfrac{1}{2} c_1(X)] \cdot H^{d-1}$. Now Simpson defines the slope as,
\[ \mu_{\text{simpson}}(\E) = \frac{a}{r} = \frac{c_1(\E) \cdot H^n}{\rank{\E}} + \frac{1}{2} c_1(X) \cdot H^{d-1} \]
which is exactly our notion of slope up to an additive constant hence the two notions of $\mu$-stability are identical. However, in the case $\mu(\E) = 0$ it is convenient to have a slightly finer notion of stability which takes into account higher Chern classes. The easiest way to do this is Simpson's notion of $p$-stability which makes his proofs of boundedness easier.
\end{rmk}

\begin{defn}
A coherent sheaf $\E$ is \textit{pure dimension} $d = d(\E)$ if for any nonzero subsheaf $\F \subset \E$ we have $\dim{\Supp{}{\F}} = d$. A coherent sheaf $\E$ is $p$-\textit{semistable} (resp. $p$-\textit{stable}) if it is of pure dimension and for any subsheaf $\F \subset \E$ we have
\[ \frac{p(\F, n)}{\rank{\F}} \le \frac{p(\E, n)}{\rank{\F}} \]
for all $n \gg 0$.  
\end{defn}

These notions are equivalent when $X$ is a curve.
\bigskip\\
Note that an asymtotic inequality of polynomials gives an inequality on their leading term that differes hence $p$-semistability implies $\mu$-semistability whereas a \textit{strict} inequality of a leading nonequal coefficnet implies \textit{strict} asymtotic inequality of the polynomials hence $\mu$-stability implies $p$-stability. 


\end{document}

