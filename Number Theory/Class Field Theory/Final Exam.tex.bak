\documentclass[12pt]{extarticle}
\include{AlgebraicNumberTheoryCommands}

    \DeclareFontFamily{U}{wncy}{}
    \DeclareFontShape{U}{wncy}{m}{n}{<->wncyr10}{}
    \DeclareSymbolFont{mcy}{U}{wncy}{m}{n}
    \DeclareMathSymbol{\Sh}{\mathord}{mcy}{"58} 

\begin{document}
\title{% 
	\large \textbf{Mathematics GR6657 Algebraic Number Theory
	\\ Final Exam} \vspace{-2ex}}
\author{Benjamin Church }
\maketitle
\section{}
Let $K$ be a number field and let $S$ be a finite set of prime ideals in $\ints{K}$. We will assume that all extensions of $K$ lie inside a fixed algebraic closure $\bar{K}$. 

\subsection*{(a)}

Let $L, L'$ are finite extensions of $K$ which are unramified outside $S$. Let $E$ be the Galois closure of $L \cdot L'$ which is also a finite extension of $K$ because it is the splitting field of the product of minimal polynomials of the generators of $L$ and $L'$. Let $\mathfrak{p} \subset K$ be a prime ideal. Consider the splitting of the prime $\mathfrak{p}$ in the Galois closure $E$,
\[ \mathfrak{p} \ints{E} = \prod_{i = 1}^g \mathfrak{P}_i^{e_{\mathfrak{P}_i | \mathfrak{p}}} \]
and the inertial group of this splitting,
\begin{center}
\begin{tikzcd}
1 \arrow[r] & I(\mathfrak{P}_i) \arrow[r] & D(\mathfrak{P}_i) \arrow[r] & \galgroup{k(E)/k(K)} \arrow[r] & 1
\end{tikzcd}
\end{center}
which has order $|I(\mathfrak{P})| = e_{\mathfrak{P} | \mathfrak{p}} = e_{E/K}$ because $E/K$ is Galois. I claim that any intermediate field $K \subset F \subset E$ satisfies $F \subset E^{I(\mathfrak{P})}$ if and only if $\mathfrak{p}$ is unramified in $F$. Suppose that $F \subset E^{I(\mathfrak{P})}$ then we know that $E/F$ is Galois (because $E/K$ is and $K \subset F \subset E$) such that $I(\mathfrak{P}) \subset \galgroup{E/F}$. We can decompose,
\[ \mathfrak{p} \ints{F} = \prod_{i = 1}^{g_F} \mathfrak{q}^{e_{\mathfrak{q}_i | \mathfrak{p}}} \]
and each $\mathfrak{q}$ splits into $\mathfrak{P}_i$ such that,
\[ e_{\mathfrak{P} | \mathfrak{p}} = e_{\mathfrak{P} | \mathfrak{q}} e_{\mathfrak{q} | \mathfrak{p}} \] 
However, $|I(\mathfrak{P})| = e_{\mathfrak{P}|\mathfrak{p}}$  which is contained in $\galgroup{E/F}$ so $e_{\mathfrak{P}|\mathfrak{p}} = e_{\mathfrak{P} | \mathfrak{q}}$. Therefore $e_{\mathfrak{q} | \mathfrak{p}} = 1$ so $\mathfrak{p}$ is unramified in $F$. 
\bigskip\\
Conversely, if $\mathfrak{p}$ is unramified in $F$ then we have $e_{\mathfrak{P} | \mathfrak{p}} = e_{\mathfrak{P} | \mathfrak{q}} e_{\mathfrak{q} | \mathfrak{p}} = e_{\mathfrak{P} | \mathfrak{q}}$. Since $E/K$ is Galois we know that $E/F$ is Galois. If $\sigma \in I_{E/F}(\mathfrak{P})$ then clearly $\sigma \in I_{E/K}(\mathfrak{P})$ so $I_{E/F}(\mathfrak{P}) \subset I_{E/K}(\mathfrak{P})$ but the orders of these groups are $e_{\mathfrak{P} | \mathfrak{q}}$ and $e_{\mathfrak{P} | \mathfrak{p}}$ which are equal. Therefore, $I_{E/K}(\mathfrak{P}) = I_{E/F}(\mathfrak{P}) \subset \galgroup{E/F}$ so by Galois theory $F \subset E^{I(\mathfrak{P})}$. 
\bigskip\\
Back to the original problem. Since $\mathfrak{p}$ is unramified in both $L, L' \subset E$ we know that $L, L' \subset E^{I(\mathfrak{P})}$. Therefore, the compositum, $L \cdot L' \subset E^{I(\mathfrak{P})}$ which implies that $\mathfrak{p}$ is unramified in $L \cdot L'$ proving the proposition.   

\subsection*{(b)}

Let $L/K$ be finite extension unramified outside of $S$. By the primitive element theorem, $L = K(\alpha)$ for some $\alpha \in L$. Let $p \in K[X]$ be the minimal polynomial of $\alpha$. Let $E$ be the splitting field of $p$ which is the Galois closure of $L$. Therefore, if $p$ has roots $\alpha_1, \cdots, \alpha_n \in \bar{K}$ then $E = K(\alpha_1, \cdots, \alpha_n) = K(\alpha_1) \cdots K(\alpha_n)$. However, basic field theory tells us that since $\alpha_i$ and $\alpha_j$ have the same minimal polynomial then $K(\alpha_i) \cong K(\alpha_j)$ by a $K$-isomorphism so if $\mathfrak{p}$ is unramified in $L = K(\alpha)$ then $\mathfrak{p}$ is unramified in $K(\alpha_i)$ for each $i$ and thus by the previous problem, $\mathfrak{p}$ is unramified in $E = K(\alpha_1) \cdots K(\alpha_n)$.  

\subsection*{(c)}

Define the maximal $S$-unramified extension $K^S$ of $K$ as the union of all extensions $L/K$ such that $L$ is unramified outside $S$. For each $L/K$ in the union, we can replace $L$ with its Galois closure $E/K$ which is still unramified outside $S$. Therefore,
\[ K^S = \bigcup_{L/K} L = \bigcup_{E/K} E \]
because $E \supset L$ and $E/K$ is unramified outside $S$ so it appears in the union. Therefore, $K^S/K$ is the direct limit of finite Galois extensions and thus is Galois with Galois group,
\[ \Gamma_S = \galgroup{K^S / K } = \varprojlim_{E/K} \galgroup{E/K} \]
where the projective limit runs over finite galois extensions $E/K$ which are unramified outside $S$.

\section{}

Let $K$ be a number field and $M$ be a finite abelian group of order $N$ with a continuous action of $\galgroup{\bar{K}/K}$.

\subsection*{(a)}

Consider the action $\phi : \galgroup{\bar{K}/K} \to \Aut{M}$. Since $\phi$ is continuous the sugbroup $\ker{\phi} = \phi^{-1}(1)$ is open since $M$ is discrete. By infinite Galois theory, the fixed field $L = \bar{K}^{H}$ is a finite extension of $K$ if and only if $H \subset \galgroup{\bar{K}/K}$ is an open subgroup. Therefore, $L = \bar{K}^{\ker{\phi}}$ is a finite extension of $K$ with $\galgroup{\bar{K}/L} = \ker{\phi}$. Furthermore, $\ker{\phi}$ is normal so $L/K$ is Galois with $\galgroup{L/K} = \galgroup{\bar{K}/K} / \galgroup{\bar{K}/L}$. Since $L / K$ is a finite extension, $L$ is a number field so a finite set of primes $S \subset \ints{K}$ ramify in $L/K$. Thus, $K \subset L \subset K^S \subset \bar{K}$. However, $K^S$ is Galois over $K$ and thus over $L$ so $\galgroup{\bar{K}/K^S}$ is a normal subgroup of both $\galgroup{\bar{K}/K}$ and $\galgroup{\bar{K}/L}$. By the third isomorphism theorem,
\[ \galgroup{L/K} \cong (\galgroup{\bar{K}/K}/\galgroup{\bar{K}/K^S}) / (\galgroup{\bar{K}/L} / \galgroup{\bar{K}/K^S}) \cong \galgroup{K^S / K} / \galgroup{K^S / L} \cong \Gamma_S / H \]
where $H = \galgroup{K^S / L}$. Then, the action $\phi : \galgroup{\bar{K}/K} \to \Aut{M}$ factors through its kernel,
\begin{center}
\begin{tikzcd}
\galgroup{\bar{K} / K} \arrow[r, two heads] & \galgroup{\bar{K} / K} / \ker{\phi} \arrow[r, "\sim"] & \Gamma_S / H \arrow[r] & \Aut{M}  
\end{tikzcd}  
\end{center}

\subsection*{(b)}

Consider the cohomology group $H^1(H, M)$ where $H = \galgroup{K^S/L}$ is the kernel of the action $\Gamma_S \to \Aut{M}$. Therefore, $H$ acts trivially on $M$ so,
\[ H^1(H, M) = \Hom{H}{M} \]
because the crossed homomorphisms are just normal homomorphisms and principle homomorphisms are trivial. Since $M$ is an abelian group, any map $\phi : H \to M$ factors through the abelianization $\phi' : H^{ab} \to M$. Therefore,
\[ \Hom{H}{M} = \Hom{H^{\ab}}{M} \] 
Consider the commutator subgroup\footnote{Technically we need to take the closure of the usual commutator subgroup such that the quotient is still profinite and the associated field extension is Galois.} $C = [H, H] \triangleleft H$. Since $C$ is normal in $H$ we know that the intermediate field $L \subset (K^S)^C \subset K^S$ is a galois extension of $L$. Call $L^{\ab}_S = (K^S)^C$ which I claim is the maximal abelian extension of $L$ contained in $K^S$. Since $L_S^{\ab} / K$ is Galois,
\[ \galgroup{L_S^{\ab} / L} \cong (\galgroup{K^S / L}) / (\galgroup{K^S / L_S^{\ab}} ) = H / C = H^{\ab} \]
Therefore, $L_S^{\ab} / L$ is abelian. Futhermore, if $L \subset F \subset K^S$ is an abelian extension of $L$ then $\galgroup{K^S/F} \triangleleft H$ with abelian quotient. Therefore this subgroup contains the commutator subgroup,
\[ \galgroup{K^S / L_S^{\ab}} = C \subset \galgroup{K^S/F}  \]
and thus by the Galois correspondence $F \subset L_S^{\ab}$ proving my claim. 
\bigskip\\ 
By the above argument, we need to study the group,
\[ H^1(H, M) = \Hom{\galgroup{L^{\ab}_S / L}}{M} \] 
Since this profinite Galois group is a topological group it is important that we only consider continuous homs by the definition of the group cohomology.
Let $\mathcal{G} = \galgroup{L^{\ab}_{S} / L}$. We need to consider the continuous homomorphisms,
\begin{center}
\begin{tikzcd}
\mathcal{G} \arrow[r, "\phi"] \arrow[d] & M 
\\
\mathcal{G} / \ker{\phi} \arrow[ru, hook]
\end{tikzcd}
\end{center}
Since $\phi$ is continuous, $\ker{\phi} = \phi^{-1}(1)$ is open (since $M$ is discrete) so $\ker{\phi}$ corresponds to a finite abelian extension $L \subset L^{\ker{\phi}} \subset L^{\ab}_{S}$ with $\galgroup{L^{\ker{\phi}} / L} \cong \mathcal{G} / \ker{\phi} \cong \Im{\phi} \subset M$. Write $F = L^{\ker{\phi}}$ then we know that $\galgroup{F/L}$ is isomorphic to a subgroup of $M$ and thus has exponent dividing $N$, the order of $M$.
\bigskip\\
Since $\mathcal{G}$ is a profinite group, we can write the entire set of continuous homs as a direct limit over open normal subgroups $H \triangleleft \mathcal{G}$,
\[ \Hom{\mathcal{G}}{M} = \varinjlim_{H \triangleleft \: \mathcal{G}} \Hom{ \mathcal{G} / H}{M} \] 
However, each continuous homomorphism $\phi : \mathcal{G} \to M$ is contained in the inclusion of $\Hom{\mathcal{G} / \ker{\phi}}{M}$ so we can restrict this direct limit to only such open normal subgroups which appear as kernels of homomorphisms. Therefore,
\[ \Hom{\mathcal{G}}{M} = \varinjlim_{H \triangleleft \: \mathcal{G}} \Hom{ \galgroup{F / L} }{M} \]
where $L \subset F \subset L^{\ab}_{S}$ runs over all intermediate finite abelian extension of $L$ which are unramified outside $S$ and appear as fixed fields of the kernels and consequently have degree dividing $N$.
\bigskip\\
I claim that there are finitly many abelian extensions $F/L$ with degree dividing $N$ which are unramified outside $S$. This is a consequence of the classical result that there are only finitely many extensions with a given discriminant know as the Hermite-Minkowski theorem which is proven using the Minkowski bound and geometry of numbers (see Milne ANT Thm. 8.42). I will attempt a proof in the abelian case using class field theory.

\begin{theorem}
Let $S$ be a finite set of primes of a number field $K$. There are only finitely many abelian extensions of $K$ with degree dividing $N$ which are unramified outside $S$.
\end{theorem} 

\begin{proof}
Let $L / K$ be an abelian extension of number fields of degree dividing $N$. For each $\mathfrak{p} \in S$ consider the extension of local fields $L_{\mathfrak{P}} / K_{\mathfrak{p}}$. This extension is Galois with $\galgroup{L_{\mathfrak{P}} / K_{\mathfrak{p}}} = D(\mathfrak{P}) \subset \galgroup{L / K}$. Thus, $L_{\mathfrak{P}} / K_{\mathfrak{p}}$ is a abelian extension of degree dividing $N$. However, a local field of  characteristic zero with a finite residue field has only finitely many extensions of fixed degree (see Milne ANT Prop. 7.64). Therefore, we may take the maximum local conductor of $L_{\mathfrak{P}} / K_{\mathfrak{p}}$ of all such $L / K$ with degree dividing $N$ since there only fintely many possibilities for the extension of the local field at $\mathfrak{p}$. Call this maximum condutor, $f_N(K_{\mathfrak{p}}) = \max\limits_{L / K} f(L_{\mathfrak{P}} / K_{\mathfrak{p}})$ where $L$ runs over all abelian extensions of $K$ with degree dividing $N$ which are unramified outside $S$. Define a modulus of $K$,
\[ \mathfrak{m} = \mathfrak{m}_{\infty} \prod_{\mathfrak{p} \in S} \mathfrak{p}^{f_N(K_{\mathfrak{p}})} \]
where $\mathfrak{m}_{\infty}$ is the product of all archimedean primes of $K$.
By global class field theory, there is a correspondence between subgroups of the ray class group $C_{\mathfrak{m}}$ and abelian intermediate extensions $K \subset L \subset L_{\mathfrak{m}}$ where $L_{\mathfrak{m}}$ is the ray class field associated with the modulus $\mathfrak{m}$. Consider any extension $L / K$ with degree dividing $N$ which is unramified outside $S$. The conductor of this extension can be written in terms of the local conductors as,
\[ \mathfrak{f}_0(L / K) = \prod_{\mathfrak{p} \in S} \mathfrak{p}^{f(L_{\mathfrak{P}} / K_{\mathfrak{p}})} \]
where the product can be restricted to run over primes in $S$ because a prime appears in the factorization of the conductor if and only if it is ramified in $L/K$ and $L/K$ is unramified outside $S$. Furthermore, since $L/K$ has degree dividing $N$ its local conductors are bounded by the maximum local conductors $f_N(K_{\mathfrak{p}})$. Therefore,
\[  \mathfrak{f}_0(L / K) = \prod_{\mathfrak{p} \in S} \mathfrak{p}^{f(L_{\mathfrak{P}} / K_{\mathfrak{p}})} \supset \prod_{\mathfrak{p} \in S} \mathfrak{p}^{f_N(K_{\mathfrak{p}})} = \mathfrak{m}_0 \]
and thus including any infinite primes ramifying in $L/K$ we have, $\mathfrak{f}(L / K) \divides \mathfrak{m}$. Therefore, the global Artin map $\theta_{L/K} : I^S \to \galgroup{L/K}$ factors through $C_{\mathfrak{m}}$ so $L$ is conatined in the ray class field, $K \subset L \subset L_{\mathfrak{m}}$. Therefore, $L$ corresponds the kernel of the global Artin map $\theta_{L/K} : C_{\mathfrak{m}} \to \galgroup{L/K}$. However, the ray class group $C_{\mathfrak{m}}$ is finite so there are only finitly many abelian extensions of $K$ containted in the ray class field $L_{\mathfrak{m}}$ proving the theorem. 
\end{proof}
\bigskip
\noindent
Given this theorem, we can complete the proof. We have shown that,
\[ H^1(H, M) = \Hom{H}{M} = \Hom{\galgroup{L^{\ab}_S}}{M} = \varinjlim \Hom{\galgroup{F/L}}{M} \]
where $F$ runs over finite abelian extensions of degree dividing $N$ which are unramified outside $S$. However, I have shown that there are finitely many such $F/L$. Furthermore, since $\galgroup{F/L}$ and $M$ are finite, $\Hom{\galgroup{F/L}}{M}$ is finite. Thus, $H^1(H, M)$ is the direct limit of a finite set of finite groups which is finite.  

\subsection*{(c)}

Consider the inflation-restriction sequence for the group $\Gamma_S = \galgroup{K^S/K}$ with normal subgroup $H$,
\begin{center}
\begin{tikzcd}
1 \arrow[r] & H^r(\Gamma_S/H, M^H) \arrow[r, "\inf"] & H^r(\Gamma_S, M) \arrow[r, "\mathrm{res}"] & H^r(H, M) 
\end{tikzcd}
\end{center}
However, we have shown above that $H^1(H, M)$ is finite. Furthermore, $\Gamma_S/H$ and $M^H$ are finite groups which implies that $H^1(\Gamma_S/H, M^H)$ is finite since there is a finite number of crossed homomorphisms because each is determined by the image of each $g \in G$ in $M$ which is a finite number of choices. Thus, we get the following exact sequence,
\begin{center}
\begin{tikzcd}
1 \arrow[r] & H^1(\Gamma_S/H, M^H) \arrow[r, "\inf"] & H^1(\Gamma_S, M) \arrow[r, "\mathrm{res}"] & H^1(H, M) 
\end{tikzcd}
\end{center}
and thus,
\[ H^1(\Gamma_S, M) / H^1(\Gamma_S/H, M^H) \cong \Im{\mathrm{res}} \]
and thus,
\[ |H^1(\Gamma_S, M)| = |H^1(\Gamma_S/H, M^H)| \cdot | \Im{\mathrm{res}} | \le |H^1(\Gamma_S/H, M^H)| \cdot | H^1(H, M) | \]
In particular, since $H^1(\Gamma_S/H, M^H)$ and $H^1(H, M)$ are finite we have that $H^1(\Gamma_S, M)$ is finite.

\section{}

Let $K$ be a number field containing the $N^{\mathrm{th}}$ roots of unity and $M$ a finite abelian group.

\subsection*{(a)}

Let $S$ be a set of primes of $\ints{K}$ and let $U_{K,S} \subset K^\times$ be the subgroup of $S$-units. Let $u \in U_{K,S}$ and consider the extension $K_u = K(\sqrt[N]{u})$. Since $(\sqrt[N]{u})^N = u \in K$ and $K$ contains all $N^{\text{th}}$ roots of unity and thus by the cyclic extension theorem, the extension $L/K$ is cyclic and thus abelian. Take the polynomial $f \in K[X]$ given by $f(X) = X^N - u$ and let $\alpha = \sqrt[N]{u}$. Let $p \in K[X]$ be the minimal polynomial of $\alpha$ with degree $m$. Then since $f(\alpha) = 0$ we know that $p \divides f$ and thus,
\[ D(1, \alpha, \alpha^2, \dots, \alpha^{m-1}) = \disc{p} \divides \disc{f} \]   
Let $\Delta_{L/K}$ be the relative discriminant of $L/K$ then $D(1, \alpha, \alpha^2, \dots, \alpha^{m-1}) \in \Delta_{L/K}$ and because $\Delta_{L/K}$ is an ideal we know that $\disc{f} \in \Delta_{L/K}$. However, we can calculate the discriminant of $f$,
\[ |\disc{f}| = \norm{L}{K}{f'(\alpha)} = \norm{L}{K}{N \alpha^{N-1}} = N^{m} u^{N-1} \]  
Since $\disc{f} \in \Delta_{L/K}$ we know that as ideals,
\[ \Delta_{L/K} \supset (\disc{f}) = (N^m u^{m-1}) = (N)^m (u)^{m-1}  \]
Therefore if a prime $\mathfrak{p}$ in $\ints{K}$ is ramified then $\mathfrak{p}$ lies above $\Delta_{L/K}$ and thus $\mathfrak{p}$ lies above $(N)^m (u)^{m-1}$. By the uniqueness of Dedekind prime factorization, $\mathfrak{p}$ must appear in either the factorization of either the ideal $(N)$ or the ideal $(u)$. However, by assumption, $u$ is a $S$-unit so $(u)$ factors as a product of primes in $S$. Thus, if $\mathfrak{p}$ is a prime outside $S$ which does not not divide $(N)$ then $\mathfrak{p}$ must be unramified. 

\subsection*{(b)}

From problem 2, we know that to prove that $H^1(\Gamma_{S(N)}, M)$ is finite it suffices to show that $H^1(H, M) =\Hom{\galgroup{L^{\ab}_{S(N)} / L}}{M}$ is finite which gives the required result via the inflation-restriction sequence.
\bigskip\\
Let $\mathcal{G} = \galgroup{L^{\ab}_{S(N)} / L}$. We need to consider the continuous homomorphisms,
\begin{center}
\begin{tikzcd}
\mathcal{G} \arrow[r, "\phi"] \arrow[d] & M 
\\
\mathcal{G} / \ker{\phi} \arrow[ru, hook]
\end{tikzcd}
\end{center}
Since $\phi$ is continuous, $\ker{\phi} = \psi^{-1}(1)$ is open (since $M$ is discrete) so $\ker{\phi}$ corresponds to a finite abelian extension $L \subset L^{\ker{\phi}} \subset L^{\ab}_{S(N)}$ with $\galgroup{L^{\ker{\phi}} / L} \cong \mathcal{G} / \ker{\phi} \cong \Im{\phi} \subset M$. Write $F = L^{\ker{\phi}}$ then we know that $\galgroup{F/L}$ is isomorphic to a subgroup of $M$ and thus has exponent dividing $N$, the order of $M$.
\bigskip\\
Since $\mathcal{G}$ is a profinite group, we can write the entire set of continuous homs as a direct limit over open normal subgroups $H \triangleleft \mathcal{G}$,
\[ \Hom{\mathcal{G}}{M} = \varinjlim_{H \triangleleft \: \mathcal{G}} \Hom{ \mathcal{G} / H}{M} \] 
However, since each continuous homomorphism $\phi : \mathcal{G} \to M$ is contained in the inclusion of $\Hom{\mathcal{G} / \ker{\phi}}{M}$ we can restrict this direct limit to only such open normal subgroups which appear as kernels of such homomorphisms. Therefore,
\[ \Hom{\mathcal{G}}{M} = \varinjlim_{H \triangleleft \: \mathcal{G}} \Hom{ \galgroup{F / L} }{M} \]
where $L \subset F \subset L^{\ab}_{S(N)}$ runs over all intermediate finite extensions of $L$ which are unramified outside $S(N)$ and appear as fixed fields of the kernels and consequently are finite abelian extensions of exponent dividing $N$. Since $K \subset L$ contain all $N^{\mathrm{th}}$ roots of unity, by Kummer theory, there is a correspondence between finite abelian extensions of $L$ with exponent dividing $N$ and finite subgroups of $L^\times / (L^\times)^N$. In particular,
\[ F / L \mapsto \Delta = \frac{L^\times \cap (F^\times)^N}{(L^\times)^{N}} \subset \frac{L^\times}{(L^\times)^N} \quad \text{and} \quad \Delta \subset \frac{L^\times}{(L^\times)^N} \mapsto L[\Delta^{1/N}] / L \]
Given an intermediate Galois extension $L \subset F \subset L^{\ab}_{S(N)}$ with exponent dividing $N$ we know that $F/L$ is abelian and $F/K$ is unramified outside $S(N)$ since $F \subset L^{\ab}_{S(N)} \subset K^S$. Take any $u \in \Delta$. The fractional ideal $u \ints{L}$ must factor into primes lying above $S(N)$ since in $F$, the ideal $(u) = u \ints{F}$ can decompose as $(u) = (\sqrt[N]{u})^N$ and thus each prime factor of the fractional ideal $u \ints{L}$ totally ramifies in the extension $F/L$. However, $F/K$ is unramified outside $S(N)$ so any prime which ramifies in $F/L$ must lie above a prime in $S(N)$.  By lemma \ref{finite_s_units}, the image of the $S$-units inside $L^\times / (L^\times)^N$ is finite. However, $\Delta \subset U_{L,S}$ so there are finitely many possible subgroups $\Delta$ and thus finitely many finite abelian extensions of $L$ with exponent dividing $N$ which are unramified outside $S(N)$. Furthermore, each $\Hom{ \galgroup{F / L} }{M}$ is a finite group because each $F/L$ is a finite extension and thus both $\galgroup{L/K}$ and $M$ are finite groups so there are a finite number of maps between them. Thus, 
\[ H^1(H, M) = \Hom{\mathcal{G}}{M} = \varinjlim_{H \triangleleft \: \mathcal{G}} \Hom{ \galgroup{F / L} }{M} \]
is contained in the union of finitely many finite groups and is therefore finite. 

\section{}

Let $K$ be a number field. Take any finite Galois extension $L/K$ and
consider the commutative diragram with exact rows and columns,
\begin{center}
\begin{tikzcd}
& 1 \arrow[d] & 1 \arrow[d] & 1 \arrow[d]
\\ 
1 \arrow[r] & \ints{L} \arrow[d] \arrow[r] & L^\times \arrow[d] \arrow[r] & P_L \arrow[d] \arrow[r] & 1
\\
1 \arrow[r] & \sidele{L}{S_{\infty}} \arrow[r] & \idele{L} \arrow[r] & I_L \arrow[r] & 1
\end{tikzcd}
\end{center}
where $P_L$ is the group of principal fractional ideals of $L$ and $I_L$ is the group of all fractional ideals of $L$. The downward maps are inclusions. Let $G = \galgroup{L/K}$. Now we take the long exact sequence of cohomology of each of the short exact rows which is natural. The downward maps remain injective because $(-)^G$ is left-exact,
\begin{center}
\begin{tikzcd}
& 1 \arrow[d] & 1 \arrow[d] & 1 \arrow[d]
\\ 
1 \arrow[r] & (\ints{L}^\times)^G \arrow[d] \arrow[r] & (L^\times)^G \arrow[d] \arrow[r] & (P_L)^G \arrow[d] \arrow[r] & H^1(G, \ints{L}^\times) \arrow[d] \arrow[r] & H^1(G, L^\times) 
\arrow[d]
\\
1 \arrow[r] & (\sidele{L}{S_{\infty}})^G \arrow[r] & (\idele{L})^G \arrow[r] & (I_L)^G \arrow[r] & H^1(G, \sidele{L}{S_\infty}) \arrow[r] & H^1(G, \idele{L}) 
\end{tikzcd}
\end{center}
By Galois theory, $(\ints{L}^\times)^G = \ints{K}$ and $(L^\times)^G = K^\times$. Furthermore, by Lemma \ref{particulars}, we also have $(\sidele{L}{S_\infty})^G = \sidele{L}{S_{\infty}}$ and $(\idele{L})^G = \idele{K}$. By Hilbert's theorem 90, $H^1(G, L^\times) = 1$ and by Lemma \ref{particulars}, $H^1(G, \idele{L}) = 1$. Therefore, extending the sequence through the image of the maps $K^\times \to (P_L)^G$ and $\idele{K} \to (I_L)^G$ we get the commutative diagram with exact rows, 
\begin{center}
\begin{tikzcd}
& & 1 \arrow[rd] & & 1
\\
& & & P_K \arrow[ddd, hook] \arrow[rd] \arrow[ru]
\\
1 \arrow[r] & \ints{K} \arrow[d, hook] \arrow[r] & K^\times \arrow[d, hook] \arrow[ru] &  & (P_L)^G \arrow[d, hook] \arrow[r] & H^1(G, \ints{L}^\times) \arrow[d] \arrow[r] & 1
\\
1 \arrow[r] & \sidele{K}{S_{\infty}} \arrow[r] & \idele{K} \arrow[rd] & & (I_L)^G \arrow[r] & H^1(G, \sidele{L}{S_\infty}) \arrow[r] & 1
\\
& & & I_K \arrow[ru] \arrow[rd]
\\
& & 1 \arrow[ru] & & 1
\end{tikzcd}
\end{center}
This gives a commutative diagram with exact rows and columns,
\begin{center}
\begin{tikzcd}
& 1 \arrow[d] & 1 \arrow[d]
\\
1 \arrow[r] & P_K \arrow[d] \arrow[r] & (P_L)^G \arrow[d] \arrow[r] & H^1(G, \ints{L}^\times) \arrow[d] \arrow[r] & 1
\\
1 \arrow[r] & I_K \arrow[r] & (I_L)^G \arrow[r] & H^1(G, \sidele{L}{S_{\infty}}) \arrow[r] & 1
\end{tikzcd}
\end{center}
The direct limit is an exact functor so appling the direct limit over all finite Galois extensions $L/K$ gives rise to a commutative diagram with exact rows and columns,
\begin{center}
\begin{tikzcd}
& 1 \arrow[d] & 1 \arrow[d]
\\
1 \arrow[r] & \varinjlim\limits_{L/K} P_K \arrow[d] \arrow[r] & \varinjlim\limits_{L/K} (P_L)^{G_{L/K}} \arrow[d] \arrow[r] & \varinjlim\limits_{L/K} H^1(G_{L/K}, \ints{L}^\times) \arrow[d] \arrow[r] & 1
\\
1 \arrow[r] & \varinjlim\limits_{L/K} I_K \arrow[r] & \varinjlim\limits_{L/K} (I_L)^{G_{L/K}} \arrow[r] & \varinjlim\limits_{L/K} H^1(G_{L/K}, \sidele{L}{S_{\infty}}) \arrow[r] & 1
\end{tikzcd}
\end{center}
However, $\varinjlim\limits_{L/K} P_K = P_K$ and $\varinjlim\limits_{L/K} I_K = I_K$ because the directed systems are constant. Furthermore, let $\bar{G} = \galgroup{\bar{K}/K}$ be the absolute Galois group. By Lemma \ref{direct_lim}, we know that,
\[ H^r(\bar{G}, \ints{\bar{K}}^\times) = \varinjlim H^r(\bar{G} / H, (\ints{\bar{K}}^\times)^H) \]
where the direct limit runs over all open normal subgroups. However, the open normal subgroups correspond exactly to finite Galois extensions $L/K$. Given an open normal subgroup $H$ we get an intermediate field $K \subset \bar{K}^H \subset \bar{K}$ with galois group $\galgroup{\bar{K} / \bar{K}^H}$. Since $H$ is normal, the extenson $\bar{K}^H / K$ is galois and $\galgroup{\bar{K}^H / K} \cong \bar{G} / H$. Furthermore, let $L = \bar{K}^H$ then $(\ints{\bar{K}}^\times)^H = \ints{\bar{K}}^\times \cap L = \ints{L}^\times$. Therefore, the cohomology of the absolute Galois group can be identified with the direct limit of the cohomology of finite Galois extensions of $K$,
\[ H^r(\bar{G}, \ints{\bar{K}}^\times) = \varinjlim_{L / K} H^r( \galgroup{L/K} , \ints{L}^\times) \]
Furthermore, let $K_v$ be the completion of $K$ at the non-archimedean prime $v$ and let $\bar{K}_v$ be its algebraic closure. Let $\bar{G}_v = \galgroup{\bar{K}_v / K}$. As before,   
\[ H^r(\bar{G}_v, \ints{\bar{K}_v}^\times) = \varinjlim H^r(\bar{G}_v / H, (\ints{\bar{K}_v}^\times)^H) \]
over open normal subgroups which correspond to finite Galois extensions $K_v \subset \bar{K}_v^H \subset \bar{K}_v$ of the local field at $v$. Since $H$ is open $\bar{K}_v^H / K_v$ is finite and since $H$ is normal $\bar{K}_v^H / K_v$ is galois with $\galgroup{\bar{K}_v^H /K_v} \cong \bar{G}_v / H$. Therefore, we can write the Galois group of the local algebraic closure as the direct limit of the Galois groups of all finite galois extensions of the local field $K_v$,
\[ H^r(\bar{G}_v, \ints{\bar{K}_v}^\times) = \varinjlim_{L_w / K_v} H^r(\galgroup{L_w/K_v}, \ints{w}^\times)  \]
By Lemma \ref{ramified_primes_decomp},
\[ H^r( G_{L/K}, \sidele{L}{S_{\infty}}) = \prod_{v \ndivides \infty} H^r(G_w, \ints{w}^\times) \times \prod_{v \divides \infty} H^r(G_w, L_w^\times) \]
and thus, applying Hilbert's theorem 90,
\[ H^1( G_{L/K}, \sidele{L}{S_{\infty}}) = \prod_{v \ndivides \infty} H^1(G_w, \ints{w}^\times)\]
Finally,
\[ \varinjlim_{L/K} H^1(G_{L/K}, \sidele{L}{S_{\infty}}) = \prod_{v \ndivides \infty} \varinjlim_{L/K} H^1(G_w, \ints{w}^\times) = \prod_{v \ndivides \infty}  H^1(\bar{G}_v, \ints{\bar{K}_v}^\times)
\]
Now we define the space $\Sh_K$ as the kernel of the induced map,
\[ H^1(\bar{G}, \ints{\bar{K}}^\times) \longrightarrow \prod_{v \ndivides \infty} H^1(\bar{G}_v, \ints{\bar{K}_v}^\times) \] 
Putting everything together, we get a commutative diagram with exact rows and columns,
\begin{center}
\begin{tikzcd}
& 1 \arrow[d] \arrow[r] & 1 \arrow[draw=none]{ddd}[name=Z, shape=coordinate]{} \arrow[d] \arrow[r] & \Sh_K \arrow[d] 
\\
1 \arrow[r] & P_K \arrow[d] \arrow[r] & \varinjlim (P_L^{G_{L/K}}) \arrow[d] \arrow[r] & H^1(\bar{G}, \ints{\bar{K}}^\times) \arrow[d] \arrow[r] & 1
\\
1 \arrow[r] & I_K \arrow[r] \arrow[d] & \varinjlim (I_L^{G_{L/K}}) \arrow[r] \arrow[d] & \prod H^1(\bar{G}_v, \ints{\bar{K}_v}^\times)\arrow[r] \arrow[d] & 1
\\
& \Cl{K} \arrow[from=uuurr, dashed,
rounded corners, crossing over,
to path={ -- ([xshift=16ex]\tikztostart.east)
|- (Z) [near end]\tikztonodes
-| ([xshift=-12ex]\tikztotarget.west)
-- (\tikztotarget)}] \arrow[r] & \coker \arrow[r] & \coker 
\end{tikzcd}
\end{center}
and by the snake lemma we get a connecting map forming an exact sequence of the kernels and cokernels. However, consider an ideal class $[J] \in \Cl{K}$. This ideal class is in the image of $J \in I_K$ under the quotient map. The map $P_K \to P_L^{G_{L/K}}$ takes $I \mapsto I \ints{L}$ which is clealy fixed by $G_{L/K}$. However, by Lemma \ref{big_enough_for_prin}, there exists a finite Galois extension $L/K$ such that for any ideal $I$ in $\ints{K}$ the ideal $I \ints{L}$ is principal. In fact, every ideal of $K$ is principal in the Hilbert class field $H_K$. Furthermore, if $F$ is a field extension of $L$ then $I$ is also principal in $F$ since $F \supset L$ contains an element which generates $I$. Thus, $I$ is principal in the direct limit, $\varinjlim (P_L^{G_{L/K}})$. Therefore, $I$ is in the image of the principal ideals and thus maps to zero in the cokernel. By commutativity of the diagram, the map $\Cl{K} \to \coker$ is the zero map. Therefore, the kernel-cokernel exact sequence reduces to,
\begin{center}
\begin{tikzcd}
1 \arrow[r] & \Sh_K \arrow[r] & \Cl{K} \arrow[r] & 1
\end{tikzcd}
\end{center} 
and thus the connecting map $\Sh_K \xrightarrow{\sim} \Cl{K}$ is an isomorphism. 

\section{Lemmata}

\begin{lemma}
If $f : A \to F$ is a surjective map of abelian groups and $F$ is free then $A \cong \ker{f} \oplus F$.
\end{lemma}

\begin{proof}
Let $f : A \to F$ be a surjective map of abelian groups where $F$ is a free abelian group. Since $F$ is free, it is a projective object in the category of abelian groups so we have a commutative diagram which I have extended to an exact sequence,
\begin{center}
\begin{tikzcd}
&& & F \arrow[d, "\id_F"] \arrow[dl, dashed, "h"']
\\
0 \arrow[r] & \ker{f} \arrow[r, hook] & A \arrow[r, "f", two heads] & F \arrow[r] & 0
\end{tikzcd}
\end{center}
Since $f$ is surjective and $F$ is projective there exits a map $h : F \to A$ such that the diagram commutes. Thus, $f \circ h = \id_F$ so the exact sequence splits on the right. Therefore, $A \cong \ker{f} \oplus F$. 
\end{proof}

\begin{lemma} \label{finite_s_units}
In a number field $K$, the group $U_{K,S}$ of $S$-units is a finitely generated abelian group. In particular, $U_{K,S} \cong \ints{K}^\times \oplus F$ where $F$ is the free abelian group on $k \le |S|$ generators. 
\end{lemma}

\begin{proof}
Let $S$ be a finite set of primes in $\ints{K}$. Consider the map, $\Phi : U_{K,S} \to \Z^S$ defined by, 
\[u \mapsto ( \ord_{\mathfrak{p}_1}(u), \dots, \ord_{\mathfrak{p}_k}(u))\]
where $\mathfrak{p}_i$ enumerates the primes in $S$. This map is clearly a homomorphism because the order map is a valuation. 
The image of this map is a subgroup of the free abelian group $\Z^S$ and therefore the image $F = \Im{\Phi}$ is itself free abelian. Suppose that $u \in \ker{\Phi}$ then we know that $\ord_{\mathfrak{p}} (u) = 0$ for each $\mathfrak{p} \in S$. Thus, no prime in $S$ appears in the factorization of $(u)$ but $u$ is an $S$ unit so no prime can appear in its factorization at all. Thus, $(u) = \ints{K}$ so $u \in \ints{K}^\times$ is a unit. Therefore, $\ker{\Phi} = \ints{K}^\times$. By the previous lemma, since $\Phi : U_{K,S} \to F$ is a surjective map of abelian groups with $F$ free, we know that $U_{K,S} \cong \ints{K}^\times \oplus F$. Therefore $U_{K,S}$ is finitely generated by Dirichlet's unit theorem and the fact that $F \subset \Z^S$ is finitely generated since $S$ is finite.   
\end{proof}

\begin{lemma} \label{finite_s_units}
Let $K$ be a number field. The set of $S$-units for a finite set of primes of $K$ modulo $n^{\text{th}}$ powers is finite. That is, the group, $U_{K,S} /(U_{K, S} \cap (K^\times)^n)$ is finite.
\end{lemma}

\begin{proof}
This is immediate from the previous lemma. Since $U_{K,S}$ is finitely generated as an abelian group its quotient by the image of the $n^{\text{th}}$ power map is torsion but also finitely generated and thus finite. 
\end{proof}

\begin{lemma} \label{big_enough_for_prin}
Let $K$ be a number field. Then there exists a finite galois extension $L / K$ such that every ideal of $\ints{K}$ is principal in $\ints{L}$. Explicitly, for any ideal $I \subset \ints{K}$ the ideal $I \ints{L}$ is principal. 
\end{lemma}

\begin{proof}
Let $\Cl{K}$ be the class group of $K$ with order $h_K$. Let $[J_1], \cdots, [J_h]$ enumerate the elements of $\Cl{K}$ with choosen representatives. Since the class group is finite, it has exponent dividing its order. Thus, $J_k^h = (a_k)$ is a principal ideal in $K$ for each $k$. Consider the field $L$ which is the galois closure of $K(\sqrt[h]{a_1}, \cdots, \sqrt[h]{a_h})$. Consider the $\ints{L}$-ideals $J_k \ints{L}$ and $(\sqrt[h]{a_k})$. We know that $(J_k \ints{L})^h = a_k \ints{L} = (a_k)$ and $(\sqrt[h]{a_k})^h = (a_k)$. Thus, $(J_k \ints{L})^h = (\sqrt[h]{a_k})^h$ so by the uniqueness of Dedekind prime factorization,
\[ J_k \ints{L} = (\sqrt[h]{a_k}) \]
and thus each $J_k$ are principal in $\ints{L}$. Take any ideal $I \subset \ints{K}$. Consider the image $[I] \in \Cl{K}$. Since $\Cl{K}$ is finite, $I \sim J_k$ for some $k$. Therefore, there exist constants $\alpha, \beta \in \ints{K}$ such that $\alpha I = \beta J_k$. Therefore, $\alpha I \ints{L} = \beta J_k \ints{L} = \beta (\sqrt[h]{a_k})$ so $I \ints{L}$ is itself principal.
\end{proof}

\begin{lemma} \label{direct_lim}
Let $G$ be a profinite group and $M$ a $G$-module. Then,
\[ \varinjlim H^r(G / H, M^H) = H^r(G, M) \]
where $H$ runs over open normal subgroups. 
\end{lemma}

\begin{proof}
The groups $H^r(G / H, M^H)$ form a directed system where $H_1 \subset H_2$ gives maps $\bar{G} / H_1 \to \bar{G} / H_2$ and $M^{H_2} \to M^{H_1}$ which induce a map $H^r(\bar{G} / H_1, M^{H_1}) \to H^r(\bar{G} / H_2, M^{H_2})$. Furthermore, for the normal subgroups $H \triangleleft G$ the inflation maps,
\[ \inf : H^r(G / H, M^H) \to H^r(G, M) \] 
give inclusions of each $H^r(G / H, M^H)$ into $H^r(G, M)$. Since $G$ is profinite, if we restrict to the open subgroups then $H^r(G, M)$ with the inflation maps is universal with respect to cocones over the directed system. 

\end{proof}
\begin{lemma} \label{decomp_cohomology}
Let $L/K$ be a finite Galois extension of number fields with Galois group $G = \galgroup{L/K}$. Let $v$ be a prime of $K$ with a prime $w$ in $L$ such that $w \divides v$. Let $G_w = \galgroup{L_w / L_v}$ be the decomposition group at $w \divides v$ then,
\[ H^r(G, \prod_{w \divides v} L_w^\times) \cong H^r(G_w, L_{w}^\times) \] 
and likewise,
\[ H^r(G, \prod_{w \divides v} \ints{w}^\times) \cong H^r(G_w, \ints{w}^\times) \] 
\end{lemma} 

\begin{proof}
We use the fact that,
\[ \prod_{w \divides v} L_w^\times = \Ind{G}{G_w} L_{w}^\times \]
and similarly, that,
\[ \prod_{w \divides v} \ints{w}^\times = \Ind{G}{G_w} \ints{w}^\times \]
Therefore, by Shapiro’s Lemma,
\[ H^r(G, \prod_{w \divides v} L_w^\times) = H^r(G, \Ind{G}{G_w} L_{w}^\times) = H^r(G_w, L_{w}^\times) \]
and similarly,
\[ H^r(G, \prod_{w \divides v} \ints{w}^\times) = H^r(G, \Ind{G}{G_w} \ints{w}^\times) = H^r(G_w, \ints{w}^\times) \]
\end{proof}

\begin{lemma} \label{ramification}
Let $L/K$ be a finite Galois extension of number fields. Let $\mathfrak{p}$ be a finite prime in $K$ and $\mathfrak{P}$ a prime of $L$ lying above $v$ with ramification index $e_{\mathfrak{P} | \mathfrak{p}}$ and decomposition group $D(\mathfrak{P}) = \galgroup{L_{\mathfrak{P}}/K_{\mathfrak{p}}}$. Then, 
\[H^1(D(\mathfrak{P}), \ints{\mathfrak{P}}^\times) \cong \Z / e_{\mathfrak{P} | \mathfrak{p}} \Z\]
\end{lemma}

\begin{proof}
Let $D = \galgroup{L_{\mathfrak{P}}/K_{\mathfrak{p}}}$. Consider the short exact sequence associated to a local field $L_w$,
\begin{center}
\begin{tikzcd}
1 \arrow[r] & \ints{\mathfrak{P}}^\times \arrow[r] & L^\times_{\mathfrak{P}} \arrow[r, "\ord_{\mathfrak{P}}"] & \Z \arrow[r] & 1 
\end{tikzcd}
\end{center}
This short exact sequence gives rise to a long exact sequence of cohomology,
\begin{center}
\begin{tikzcd}
1 \arrow[r] & (\ints{\mathfrak{P}}^\times)^D \arrow[r] & (L^\times_{\mathfrak{P}})^D \arrow[r, "\ord_{\mathfrak{P}}"] & \Z^D \arrow[r] & H^1(D, \ints{\mathfrak{P}}^\times) \arrow[r] & H^1(D, L_{\mathfrak{P}}^\times) \arrow[r] & \cdots 
\end{tikzcd}
\end{center}
However, by Hilbert's Theorem 90, $H^1(D, \ints{\mathfrak{P}}^\times) = 1$ so we get he exact sequence,
\begin{center}
\begin{tikzcd}
1 \arrow[r] & \ints{\mathfrak{p}}^\times\arrow[r] & K^\times_{\mathfrak{p}} \arrow[r, "\ord_{\mathfrak{P}}"] & \Z \arrow[r, "\varphi"] & H^1(D, \ints{\mathfrak{P}}^\times) \arrow[r] & 1
\end{tikzcd}
\end{center}
However, the image of $\ord_{\mathfrak{P}}$ on $K^\times_{\mathfrak{p}}$ is determined by, 
\[\ord_{\mathfrak{P}} \left( \mathfrak{p} \right) = \ord_{\mathfrak{P}} \left( \prod_{\mathfrak{P'} \divides \mathfrak{p}} \mathfrak{P'}^e \right) = \ord_{\mathfrak{P}} \left( \mathfrak{P}^e \right) = e\]
By exactness, $\ker{\varphi} = \Im{\ord_{\mathfrak{P}}} = e \Z$ so by the first isomorphism theorem,
\[ H^1(D, \ints{\mathfrak{P}}^\times) = \Z / e \Z \]
\end{proof}

\begin{lemma} \label{ramified_primes_decomp}
Let $L/K$ be a finite Galois extension of number fields with $G = \galgroup{L/K}$. Let $S$ be a finite set of primes in $K$ with $T$ the set of primes in $L$ lying above some prime in $S$. Let $G_v = \galgroup{L_w / L_v}$ be the decomposition group at $w \divides v$ then,
\[ H^r(G, \sidele{L}{T}) = \prod_{v \notin S} H^r(G_w, \ints{w}^\times) \times \prod_{v \in S} H^r(G_w, L_{w}^\times) \] 
\end{lemma}

\begin{proof}
By definition,
\[ \sidele{L}{T} = \prod_{w \notin T} \ints{w}^\times \times \prod_{w \in T} L_w^\times = \prod_{v \notin S} \prod_{w \divides v} \ints{w}^\times \times \prod_{v \in S} \prod_{w \divides v} L_w^\times \]
which is a decomposition as a product of $G$-modules. Therefore, by the fact that cohomology commutes with products,
\[ H^r(G, \sidele{L}{T}) = \prod_{v \notin S} H^r(G, \prod_{w \divides v} \ints{w}^\times) \times \prod_{v \in S} H^r(G, \prod_{w \divides v} L_w^\times) \]
Thus, by the previous lemma,
\[ H^r(G, \sidele{L}{T}) = \prod_{v \notin S} H^r(G_w, \ints{w}^\times) \times \prod_{v \in S} H^r(G_w, L_{w}^\times) \]
\end{proof}

\begin{lemma} \label{particulars}
Let $L/K$ be a finite Galois extension of number fields with $G = \galgroup{L/K}$ then,
\[(\idele{L})^G = H^0(G, \idele{L}) = \idele{K} \quad \text{and} \quad H^1(G, \idele{L}) = 1\]
\end{lemma}

\begin{proof}
We can write,
\[ \idele{L} = \varinjlim_{T_0 \subset T} \sidele{L}{T} \]
where if $T \subset T'$ then $\sidele{L}{T} \subset \sidele{L}{T'}$. Thus, we can choose $S_0$ to contain the set of ramified primes (since there are finitely many) and $T_0$ to be all such primes lying over $T_0$. Thus,
\[ H^r(G, \idele{L}) =  \varinjlim_{T_0 \subset T} H^r(G, \sidele{L}{T}) = \varinjlim_{S_0 \subset S} \prod_{v \notin S} H^r(G_w, \ints{w}^\times) \times \prod_{v \in S} H^r(G_w, L_{w}^\times) \]
However, by assumption, all the ramified primes are in $S$ so by Lemma \ref{ramification},
\[ H^1(G_w, \ints{w}^\times) = 0 \]
Furthermore, by Hilbert's theorem 90,
\[ H^1(G_w, L_{w}^\times) = 0 \]
Thus, each chomology group in the product is zero so the limit of these groups is zero as well and therefore, 
\[ H^1(G, \idele{L}) = 0 \]
Futhermore,
\begin{align*}
H^0(G, \idele{L}{T}) & = \varinjlim_{T_0 \subset T} H^r(G, \sidele{L}{T}) = \varinjlim_{S_0 \subset S} \prod_{v \notin S} H^0(G_w, \ints{w}^\times) \times \prod_{v \in S} H^0(G_w, L_{w}^\times)
\\
& = \varinjlim_{S_0 \subset S} \prod_{v \notin S} (\ints{w}^\times)^{G_w} \times \prod_{v \in S} (L_{w}^\times)^{G_w}
= \varinjlim_{S_0 \subset S} \prod_{v \notin S} \ints{v}^\times \times \prod_{v \in S} L_v^\times = \idele{K}
\end{align*}
\end{proof}
\end{document}